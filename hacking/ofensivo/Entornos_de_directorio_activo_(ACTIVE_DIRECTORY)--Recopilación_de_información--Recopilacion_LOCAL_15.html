<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Recopilacion LOCAL</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Recopilacion LOCAL</h1><br/><p></p><p><strong><h1>Nos encontramos en la siguiente situación;</h1></strong><h1> (SAM enumeration local)</h1></p><p></p><p>Dentro de una organización con un equipo o unas credenciales de un usuario perteneciente al dominio pero sin privilegios y nuestra maquina kali.</p><p></p><p>Nuestro objetivo es recopilar información.</p><p></p><p>Para esto vamos a ver unos cuantos comandos y técnicas para recabar información a nivel local.</p><p></p><p>Para saber el usuario actual y el dominio:</p><p><div class="codebox"><pre><br /><span style="color:#888a85;font-weight:700">$env</span><span style="color:#000000;font-weight:700">:</span>Username <span style="color:#000000;font-weight:700">//</span> whoami<br /><span style="color:#888a85;font-weight:700">$env</span><span style="color:#000000;font-weight:700">:</span>UserDomain<br /></pre></div></p><p></p><p>Nombre de equipo:</p><p><div class="codebox"><pre><br /><span style="color:#888a85;font-weight:700">$env</span><span style="color:#000000;font-weight:700">:</span>ComputerName</pre></div></p><p></p><p></p><p>Ahora vamos a buscar que grupos locales hay y a que grupos pertenece el usuario.</p><p></p><p>Yo he encontrado algunos problemas para ejecutar el script pero lo he solucionado ejecutándolo de la siguiente forma:</p><p></p><p><div class="codebox"><pre><br />powershell <span style="color:#000000;font-weight:700">-</span>ep bypass<br /><span style="color:#729fcf;font-weight:400">Import-Module</span> .<span style="color:#000000;font-weight:700">\</span>powerview.ps1 <br /></pre></div></p><p></p><p>Ahora si podemos ejecutar los comando de powerview.</p><p></p><p><div class="codebox"><pre><br /><span style="color:#edd400;font-weight:400">Get-NetLocalGroup</span><br /><span style="color:#edd400;font-weight:400">Get-NetGroup</span> <span style="color:#000000;font-weight:700">-</span>UserName <span style="color:#edd400;font-weight:400">&quot;empleado1&quot;</span> | <span style="color:#729fcf;font-weight:400">select</span> name<br /><span style="color:#edd400;font-weight:400">Get-NetLocalGroupMember</span> <span style="color:#000000;font-weight:700">-</span>GroupName Administradores | <span style="color:#729fcf;font-weight:400">Select-Object</span> MemberName, IsGroup, IsDomain<br /></pre></div></p><p></p><p>Esto se puede hacer en parte con comando propios de powershell sin necesidad de powerview</p><p></p><p><div class="codebox"><pre><br /><span style="color:#edd400;font-weight:400">Get-LocalGroup</span> | <span style="color:#729fcf;font-weight:400">Select</span> Name, Objectclass, Principalsource, sid </pre></div></p><p></p><p><img src="images/15-1.png" alt="images/15-1.png" /></p><p></p><p><div class="codebox"><pre><br /><span style="color:#edd400;font-weight:400">Get-LocalGroupMember</span> <span style="color:#000000;font-weight:700">-</span><span style="color:#729fcf;font-weight:400">Group</span> Administradores</pre></div></p><p></p><p><img src="images/15-2.png" alt="images/15-2.png" /></p><p></p></div>
</body>
</html>
