<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Netcat Port-Pivot Relay</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Netcat Port-Pivot Relay</h1><br/><p></p><p></p><p>Fundamentalmente a entender en esta técnica es que en las anteriores hemos necesitado comprometer una máquina dentro de la infraestructura para poder crear el meterpreter y realizar las técnicas.</p><p></p><p>Se puede realizar este pivoting sin necesidad de establecer una conexión reversa.</p><p></p><p>El concepto comienza con la posibilidad de exponer un servicio, por ejemplo en el puerto 23 protegido por un firewall, mediante el uso de Netcat a otro puerto que si sea accesible de forma externa como el 135.</p><p></p><p>Para probar esto vamos a la máquina windows con Netcat para simular que está ofreciendo un servicio en el puerto 23.</p><p></p><p><img src="images/69-1.png" alt="images/69-1.png" /></p><p></p><p>Suponemos que el firewall permite conexiones en el puerto 40 por lo que le indicamos que todos los paquetes que reciba por el puerto 40 los redirija al 23.</p><p></p><p>Es importante tener en cuenta que el puerto no puede estar ocupado con otro servicio.</p><p></p><p><div class="codebox"><pre><br />.<span style="color:#000000;font-weight:700">\</span>ncat.exe <span style="color:#000000;font-weight:700">-</span>lvp <span style="color:#ce5c00;font-weight:400">40</span> | .<span style="color:#000000;font-weight:700">\</span>ncat.exe <span style="color:#ce5c00;font-weight:400">192.168</span>.<span style="color:#ce5c00;font-weight:400">20.13223</span> </pre></div></p><p></p><p><img src="images/69-2.png" alt="images/69-2.png" /></p><p></p><p>Ahora desde kali o cualquier máquina externa como el puerto 40 si tiene conexión externa:</p><p></p><p><img src="images/69-3.png" alt="images/69-3.png" /></p><p></p><p><img src="images/69-4.png" alt="images/69-4.png" /></p><p></p><p></p><p>Desde Linux también se puede realizar y además podemos crear un archivo fifo para evitar tener que cerrar la conexión para que lleguen los datos.</p><p></p><p><div class="codebox"><pre><br />nc <span style="color:#000000;font-weight:700">-</span>lvp <span style="color:#ce5c00;font-weight:400">23</span><br />mknod pivot p<br />nc <span style="color:#000000;font-weight:700">-</span>lvp <span style="color:#ce5c00;font-weight:400">40</span> <span style="color:#ce5c00;font-weight:400">0</span>&lt;pivot | nc <span style="color:#ce5c00;font-weight:400">127.0</span>.<span style="color:#ce5c00;font-weight:400">0.1</span> <span style="color:#ce5c00;font-weight:400">23</span> <span style="color:#ce5c00;font-weight:400">1</span>&gt;pivot<br />nc <span style="color:#ce5c00;font-weight:400">127.0</span>.<span style="color:#ce5c00;font-weight:400">0.1</span> <span style="color:#ce5c00;font-weight:400">40</span><br /></pre></div></p><p><img src="images/69-5.png" alt="images/69-5.png" /></p></div>
</body>
</html>
