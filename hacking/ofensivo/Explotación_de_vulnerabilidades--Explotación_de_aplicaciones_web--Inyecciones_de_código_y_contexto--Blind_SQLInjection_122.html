<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Blind SQLInjection</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Blind SQLInjection</h1><br/><p></p><p><h3>Comprobar si es vulnerable a SQLInjection sin mensajes de error.</h3></p><p></p><p>Normalmente al introducir errores en la consulta no es normal que devuelva un error tan obvio como en Mutillidae.</p><p></p><p>Para comprobar si se está inyectando ese código SQL sin que nos muestre ningún error en pantalla podemos hacer una consulta con retraso para saber si esto lo toma como un parámetro de consulta.</p><p></p><p><div class="codebox"><pre><br /><span style="color:#edd400;font-weight:400">&#39; union select null,sleep(20),null,null,null,null,null -- </span></pre></div></p><p></p><p>Si la consulta pasa de ser inmediata como veríamos de normal a tardar en responder el tiempo indicado sabemos que lo inyecta.</p><p></p><p>Otra forma es sabiendo como funciona la consulta, por ejemplo:</p><p></p><p><img src="images/122-1.png" alt="images/122-1.png" /></p><p></p><p>Sabemos que si le pasamos un usuario que se encuentre en la base de datos nos devuelve esa información.</p><p></p><p><div class="codebox"><pre><br />admin<span style="color:#edd400;font-weight:400">&#39; or &#39;</span>1<span style="color:#edd400;font-weight:400">&#39;=&#39;</span>1</pre></div></p><p></p><p>Si la aplicación consume esa entrada sin dar error, simplemente lo trata de forma correcta sabemos que se está inyectando y que no se hace una sanitización de la entrada.</p><p></p><p><img src="images/122-2.png" alt="images/122-2.png" /></p><p></p><p></p><p>Para aprovechar esto podemos saber el usuario que está realizando las consultas en la base de datos:</p><p></p><p><div class="codebox"><pre><br />admin<span style="color:#edd400;font-weight:400">&#39; and substring(current_user[],1,1)=&#39;</span>a</pre></div></p><p></p><p>Esto comprueba si la primera letra del usuario que ejecuta la consulta es igual a ‘a’</p><p></p><p><img src="images/122-3.png" alt="images/122-3.png" /></p><p></p><p>Si no es así devuelve error.</p><p></p><p><img src="images/122-4.png" alt="images/122-4.png" /></p><p></p><p>Como vemos si es correcto si devuelve la información por lo que sabemos que la primera letra es ‘r’ y así podemos iterar con todas las letras del abecedario hasta conseguir el nombre del usuario completo.</p><p></p><p><div class="codebox"><pre><br />admin<span style="color:#edd400;font-weight:400">&#39; and substring(current_user[],2,1)=&#39;</span>a</pre></div></p></div>
</body>
</html>
