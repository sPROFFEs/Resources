<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>HTML Injection y XSS</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>HTML Injection y XSS</h1><br/><p></p><p></p><p><strong><h2>HTML Injection &amp; XSS:</h2></strong></p><p></p><p><img src="images/127-1.png" alt="images/127-1.png" /></p><p></p><p>Si nos fijamos vemos que tenemos un canario en esta función de resolución en mutillidae.</p><p></p><p>De nuevo esto se va a reducir a una no sanitización de los inputs de la web por lo que podemos introducir código HTML.</p><p></p><p>Si capturamos con <a href="Explotación_de_vulnerabilidades--Explotación_de_aplicaciones_web--BurpSuite_118.html">BurpSuite</a>.</p><p></p><p><img src="images/127-2.png" alt="images/127-2.png" /></p><p></p><p>Nos devuelve</p><p></p><p><img src="images/127-3.png" alt="images/127-3.png" /></p><p></p><p>Teniendo esto en cuenta podemos inyectar algo de código javascript.</p><p></p><p><img src="images/127-4.png" alt="images/127-4.png" /></p><p></p><p><img src="images/127-5.png" alt="images/127-5.png" /></p><p></p><p>Podemos aprovechar esto para ejecutar algo más avanzado.</p><p>Vamos a utilizar uno de los payloads que proporciona la web.</p><p></p><p><img src="images/127-6.png" alt="images/127-6.png" /></p><p></p><p>Este payload lo que hará es dar una alerta de que la cuenta ha expirado y debe introducir de nuevo sus credenciales para loggearse para posteriormente enviarlas a un servidor del atacante.</p><p></p><p>Lo copiamos, lo codificamos en URL:</p><p></p><p><img src="images/127-7.png" alt="images/127-7.png" /></p><p></p><p>Lo inyectamos:</p><p></p><p><img src="images/127-8.png" alt="images/127-8.png" /></p><p></p><p>Se ejecuta el script:</p><p></p><p><img src="images/127-9.png" alt="images/127-9.png" /></p><p></p><p>Las credenciales quedan a disposición del atacante en su servidor:</p><p></p><p><img src="images/127-10.png" alt="images/127-10.png" /></p><p></p><p>Esto lo podemos aprovechar en un ataque de phising por ejemplo implementando el script en una URL que le pasas a la victima.</p><p></p><p>Si se recarga la página el script o la vulnerabilidad no se refleja porque esta se produce en la respuesta del servidor, en lo que este refleja.</p><p></p><p></p><p></p><p></p><p>Sería más interesante poder inyectar este código en algún sitio de la web donde se quedase de forma permanente.</p><p></p><p>Esto pasaría de ser XSS reflected a XSS stored.</p><p></p><p></p><p><strong><h2>XSS Stored:</h2></strong></p><p></p><p>Esto por ejemplo puede ser en un blog, algo que podemos publicar y queda almacenado y se ejecuta cada vez que se entre en la web.</p><p></p><p><img src="images/127-11.png" alt="images/127-11.png" /></p><p></p><p>Interceptamos con <a href="Explotación_de_vulnerabilidades--Explotación_de_aplicaciones_web--BurpSuite_118.html">BurpSuite</a>.</p><p></p><p>Editamos el payload para modificar las comillas simples por dobles:</p><p></p><p><img src="images/127-12.png" alt="images/127-12.png" /></p><p></p><p>Codificamos:</p><p></p><p><img src="images/127-13.png" alt="images/127-13.png" /></p><p></p><p>Inyectamos y :</p><p></p><p><img src="images/127-14.png" alt="images/127-14.png" /></p><p></p></div>
</body>
</html>
