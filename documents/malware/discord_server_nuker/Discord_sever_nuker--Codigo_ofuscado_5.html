<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Codigo ofuscado</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Codigo ofuscado</h1><br />
    <p>
    <div class="codebox">
      <pre><br /><span style="color:#ad7fa8;font-weight:400">from</span> <span style="color:#729fcf;font-weight:400">builtins</span> <span style="color:#ad7fa8;font-weight:400">import</span> *<br />XWWWWWWWWWXWWWXWXXW, jiliiliiijjlllllll, XWWXWXXXXWWWXXWWWXWXXXXXX, mnnnnnnnmnmmmmnmnnmmm, MMNMNNMMMMNNMNMMM = (<br />    (<span style="color:#000000;font-weight:700">lambda</span> IIIllllIlIllIIIIl: IIIllllIlIllIIIIl(<span style="color:#729fcf;font-weight:400">__import__</span>(<span style="color:#edd400;font-weight:400">&#39;\x7a\x6c\x69\x62&#39;</span>))),<br />    (<span style="color:#000000;font-weight:700">lambda</span> IIIllllIlIllIIIIl: <span style="color:#729fcf;font-weight:400">globals</span>()[<span style="color:#edd400;font-weight:400">&#39;\x65\x76\x61\x6c&#39;</span>](<br />        <span style="color:#729fcf;font-weight:400">globals</span>()[<span style="color:#edd400;font-weight:400">&#39;\x63\x6f\x6d\x70\x69\x6c\x65&#39;</span>](<br />            <span style="color:#729fcf;font-weight:400">globals</span>()[<span style="color:#edd400;font-weight:400">&#39;\x73\x74\x72&#39;</span>](<span style="color:#edd400;font-weight:400">&quot;\x67\x6c\x6f\x62\x61\x6c\x73\x28\x29\x5b\x27\x5c\x78\x36\x35\x5c\x78\x37\x36\x5c\x78\x36\x31\x5c\x78\x36\x63\x27\x5d(IIIllllIlIllIIIIl)&quot;</span>),<br />            filename=<span style="color:#edd400;font-weight:400">&#39;\x53\x32\x53\x53\x53\x53\x53\x53\x32\x53\x53\x53\x32\x32\x32\x53\x32\x53\x53&#39;</span>,<br />            mode=<span style="color:#edd400;font-weight:400">&#39;\x65\x76\x61\x6c&#39;</span>))),<br />    (<span style="color:#000000;font-weight:700">lambda</span> IIIllllIlIllIIIIl: IIIllllIlIllIIIIl[<span style="color:#edd400;font-weight:400">&#39;\x64\x65\x63\x6f\x6d\x70\x72\x65\x73\x73&#39;</span>]),<br />    (<span style="color:#000000;font-weight:700">lambda</span> mnmnmmmnmnnmnnnnm, IIIllllIlIllIIIIl: mnmnmmmnmnnmnnnnm(IIIllllIlIllIIIIl)),<br />    (<span style="color:#000000;font-weight:700">lambda</span>: (<span style="color:#000000;font-weight:700">lambda</span> IIIllllIlIllIIIIl: <span style="color:#729fcf;font-weight:400">globals</span>()[<span style="color:#edd400;font-weight:400">&#39;\x65\x76\x61\x6c&#39;</span>](<br />        <span style="color:#729fcf;font-weight:400">globals</span>()[<span style="color:#edd400;font-weight:400">&#39;\x63\x6f\x6d\x70\x69\x6c\x65&#39;</span>](<br />            <span style="color:#729fcf;font-weight:400">globals</span>()[<span style="color:#edd400;font-weight:400">&#39;\x73\x74\x72&#39;</span>](<span style="color:#edd400;font-weight:400">&quot;\x67\x6c\x6f\x62\x61\x6c\x73\x28\x29\x5b\x27\x5c\x78\x36\x35\x5c\x78\x37\x36\x5c\x78\x36\x31\x5c\x78\x36\x63\x27\x5d(IIIllllIlIllIIIIl)&quot;</span>),<br />            filename=<span style="color:#edd400;font-weight:400">&#39;\x53\x32\x53\x53\x53\x53\x53\x53\x32\x53\x53\x53\x32\x32\x32\x53\x32\x53\x53&#39;</span>,<br />            mode=<span style="color:#edd400;font-weight:400">&#39;\x65\x76\x61\x6c&#39;</span>))))(<span style="color:#edd400;font-weight:400">&#39;\x5f\x5f\x69\x6d\x70\x6f\x72\x74\x5f\x5f\x28\x27\x62\x75\x69\x6c\x74\x69\x6e\x73\x27\x29\x2e\x65\x78\x65\x63&#39;</span>))<br />)<br /><br />MMNMNNMMMMNNMNMMM()(mnnnnnnnmnmmmmnmnnmmm(XWWXWXXXXWWWXXWWWXWXXXXXX(XWWWWWWWWWXWWWXWXXW(jiliiliiijjlllllll(<span style="color:#edd400;font-weight:400">&#39;\x76\x61\x72\x73&#39;</span>))))<br /></pre>
    </div>
    </p>
    <p></p>
    <p>
    <h3>Esto es solo una muestra porque el código es muy largo, vamos a ver como está ofuscado.</h3>
    </p>
    <p></p>
    <p>
    <h3>Vamos a crear un script para intentar aclarar el contenido en el que vamos a separar el código raw contenido en
      la web porque se trata de una ofuscación en diferentes niveles.</h3>
    </p>
    <p></p>
    <p>
    <h3>Antes de proceder con el código vamos a explicar un poco por encima algunos detalles.</h3>
    </p>
    <p></p>
    <p>
    <h3>El código comienza importando todos los elementos del módulo builtins
    , lo cual le da acceso a funciones y clases básicas de Python permitiendo que el código use funciones estándar
      sin necesidad de predefinirlas.</h3>
    </p>
    <p></p>
    <p>
    <div class="codebox">
      <pre><br /><span style="color:#ad7fa8;font-weight:400">from</span> <span style="color:#729fcf;font-weight:400">builtins</span> <span style="color:#ad7fa8;font-weight:400">import</span> *</pre>
    </div>
    </p>
    <p></p>
    <p>
    <h3>Esto de aquí no son más que nombres de variables dificiles de entender que se asignan a lambda</h3></p>
    <p></p>
    <p>
    <div class="codebox">
      <pre><br />XWWWWWWWWWXWWWXWXXW,jiliiliiijjlllllll,XWWXWXXXXWWWXXWWWXWXXXXXX,mnnnnnnnmnmmmmnmnnmmm,MMNMNNMMMMNNMNMMM</pre>
    </div>
    </p>
    <p></p>
    <p>
    <h3>A continuación hace uso de la función lambda que es una herramienta poderosa que permite crear funciones
      anónimas, es decir, funciones que no tienen un nombre definido. </h3>
    <h3></h3>
    </p>
    <p>
    <h3>Estas funciones son útiles para realizar operaciones simples de manera concisa y se pueden utilizar en
      situaciones donde se necesita una función pequeña y temporal.</h3>
    </p>
    <p>
    <h3>La expresión básica es:</h3>
    </p>
    <p></p>
    <p>
    <div class="codebox">
      <pre><br /><span style="color:#000000;font-weight:700">lambda</span> argumentos: expresión<br /></pre>
    </div>
    </p>
    <p></p>
    <p>
    <h3>Donde argumentos son los parámetros de entrada y expresión es la operación que se desea realizar.</h3>
    <h3></h3>
    </p>
    <p>
    <h3>Por lo que si ordenamos un poco el código y desofuscamos el hexadecimal como se hace mas adelante con el script
      vamos a ver que:</h3>
    <h3></h3>
    </p>
    <p>
    <h3></h3>
    </p>
    <p>
    <div class="codebox">
      <pre><br />(<span style="color:#000000;font-weight:700">lambda</span> IIIllllIlIllIIIIl: IIIllllIlIllIIIIl(<span style="color:#729fcf;font-weight:400">__import__</span>(<span style="color:#edd400;font-weight:400">&#39;\x7a\x6c\x69\x62&#39;</span>)))<br /></pre>
    </div>
    </p>
    <p></p>
    <p>
    <h3>Esta función toma un argumento y ejecuta </h3>
      <div class="codebox">
        <pre><br />(<pan >__import__(&#39;zlib&#39;)</span>)))<br /></pre>
      </div>
      </p>
    <h3>Lo que significa que importa el módulo zlib que se utiliza para la compresión y descompresión de datos.</h3>
    </p>
    <p></p>
    <p>
    <div class="codebox">
      <pre><br /><span style="color:#000000;font-weight:700">lambda</span> IIIllllIlIllIIIIl:<span style="color:#729fcf;font-weight:400">globals</span>()[<span style="color:#edd400;font-weight:400">&#39;\x65\x76\x61\x6c&#39;</span>](<span style="color:#729fcf;font-weight:400">globals</span>()[<span style="color:#edd400;font-weight:400">&#39;\x63\x6f\x6d\x70\x69\x6c\x65&#39;</span>](<span style="color:#729fcf;font-weight:400">globals</span>()[<span style="color:#edd400;font-weight:400">&#39;\x73\x74\x72&#39;</span>](<span style="color:#edd400;font-weight:400">&quot;\x67\x6c\x6f\x62\x61\x6c\x73\x28\x29\x5b\x27\x5c\x78\x36\x35\x5c\x78\x37\x36\x5c\x78\x36\x31\x5c\x78\x36\x63\x27\x5d(IIIllllIlIllIIIIl)&quot;</span>),filename=<span style="color:#edd400;font-weight:400">&#39;\x53\x32\x53\x53\x53\x53\x53\x53\x32\x53\x53\x53\x32\x32\x32\x53\x32\x53\x53&#39;</span>,mode=<span style="color:#edd400;font-weight:400">&#39;\x65\x76\x61\x6c&#39;</span>)))<br /></pre>
    </div>
    </p>
    <p></p>
    <p>
    <h3>Esta función busca y ejecuta una función que está definida dentro del entorno global, usando cadenas de bytes
      para referirse a nombres de funciones, como eval y compile</h3>
    </p>
    <p></p>
    <p>
    <div class="codebox">
      <pre><br /><span style="color:#000000;font-weight:700">lambda</span> IIIllllIlIllIIIIl:IIIllllIlIllIIIIl[<span style="color:#edd400;font-weight:400">&#39;\x64\x65\x63\x6f\x6d\x70\x72\x65\x73\x73&#39;</span>])</pre>
    </div>
    </p>
    <p></p>
    <p>
    <h3>Aquí, se obtiene el atributo decompress del objeto pasado, que es parte del módulo zlib</h3>
    </p>
    <p></p>
    <p>
    <div class="codebox">
      <pre><br />(<span style="color:#000000;font-weight:700">lambda</span> mnmnmmmnmnnmnnnnm, IIIllllIlIllIIIIl: mnmnmmmnmnnmnnnnm(IIIllllIlIllIIIIl))<br /></pre>
    </div>
    </p>
    <p></p>
    <p>
    <h3>Esta función simplemente llama amnmnmmmnmnnmnnnnm  con IIIllllIlIllIIIIl como argumento.</h3>
    </p>
    <p></p>
    <p>
    <div class="codebox">
      <pre><br /><span style="color:#000000;font-weight:700">lambda</span>:(<span style="color:#000000;font-weight:700">lambda</span> IIIllllIlIllIIIIl:<span style="color:#729fcf;font-weight:400">globals</span>()[<span style="color:#edd400;font-weight:400">&#39;\x65\x76\x61\x6c&#39;</span>](<span style="color:#729fcf;font-weight:400">globals</span>()[<span style="color:#edd400;font-weight:400">&#39;\x63\x6f\x6d\x70\x69\x6c\x65&#39;</span>](<span style="color:#729fcf;font-weight:400">globals</span>()[<span style="color:#edd400;font-weight:400">&#39;\x73\x74\x72&#39;</span>](<span style="color:#edd400;font-weight:400">&quot;\x67\x6c\x6f\x62\x61\x6c\x73\x28\x29\x5b\x27\x5c\x78\x36\x35\x5c\x78\x37\x36\x5c\x78\x36\x31\x5c\x78\x36\x63\x27\x5d(IIIllllIlIllIIIIl)&quot;</span>),filename=<span style="color:#edd400;font-weight:400">&#39;\x53\x32\x53\x53\x53\x53\x53\x53\x32\x53\x53\x53\x32\x32\x32\x53\x32\x53\x53&#39;</span>,mode=<span style="color:#edd400;font-weight:400">&#39;\x65\x76\x61\x6c&#39;</span>)))(<span style="color:#edd400;font-weight:400">&#39;\x5f\x5f\x69\x6d\x70\x6f\x72\x74\x5f\x5f\x28\x27\x62\x75\x69\x6c\x74\x69\x6e\x73\x27\x29\x2e\x65\x78\x65\x63&#39;</span>))</pre>
    </div>
    </p>
    <p></p>
    <p>
    <h3>Aquí se invoca el exec para ejecutar el código que se pasa como argumento, que a su vez intenta ejecutar la llamada a eval</h3>
    </p>
    <p></p>
    <p>
    <div class="codebox">
      <pre><br />MMNMNNMMMMNNMNMMM()(mnnnnnnnmnmmmmnmnnmmm(XWWXWXXXXWWWXXWWWXWXXXXXX(XWWWWWWWWWXWWWXWXXW(jiliiliiijjlllllll(<span style="color:#edd400;font-weight:400">&#39;\x76\x61\x72\x73&#39;</span>)))</pre>
    </div>
    </p>
    <p></p>
    <p>
<h3>MMNMNNMMMMNNMNMMM</h3>
    <h3> es llamado, que resulta en una función que descomprime y ejecuta código adicional.</h3>
    <h3></h3>
    </p>
    <p>
<h3>mnnnnnnnmnmmmmnmnnmmm</h3>
    <h3> es la función que se encarga de ejecutar el código, y </h3>
    <h3>XWWWWWWWWWXWWWXWXXW</h3>
    <h3> es utilizada para generar el código que se va a descomprimir.</h3>
    </p>
    <p></p>
    <p>
    <h3>La intención final es importar el módulo zlib, descomprimir una cadena de bytes y ejecutar el código resultante</h3>
    </p>
  </div>
</body>

</html>