<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>parte 4</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>parte 4</h1><br/><p><div class="codebox"><pre><br /><span style="color:#000000;font-weight:700">class</span> <span style="color:#729fcf;font-weight:400">ttsign</span>: <span style="color:#888a85;font-weight:400">#this is the cleanest code ive ever written</span><br />    <span style="color:#000000;font-weight:700">def</span> <span style="color:#729fcf;font-weight:400">__init__</span>(<span style="color:#729fcf;font-weight:400">self</span>,params:<span style="color:#729fcf;font-weight:400">str</span>,data:<span style="color:#729fcf;font-weight:400">str</span>,cookies:<span style="color:#729fcf;font-weight:400">str</span>)-&gt;<span style="color:#ce5c00;font-weight:400">None</span>:<span style="color:#729fcf;font-weight:400">self</span>.params,<span style="color:#729fcf;font-weight:400">self</span>.data,<span style="color:#729fcf;font-weight:400">self</span>.cookies=params,data,cookies<br />    <span style="color:#000000;font-weight:700">def</span> <span style="color:#729fcf;font-weight:400">hash</span>(<span style="color:#729fcf;font-weight:400">self</span>,data:<span style="color:#729fcf;font-weight:400">str</span>)-&gt;<span style="color:#729fcf;font-weight:400">str</span>:<span style="color:#000000;font-weight:700">return</span> <span style="color:#729fcf;font-weight:400">str</span>(hashlib.md5(data.encode()).hexdigest())<br />    <span style="color:#000000;font-weight:700">def</span> <span style="color:#729fcf;font-weight:400">get_base_string</span>(<span style="color:#729fcf;font-weight:400">self</span>)-&gt;<span style="color:#729fcf;font-weight:400">str</span>:base_str=<span style="color:#729fcf;font-weight:400">self</span>.hash(<span style="color:#729fcf;font-weight:400">self</span>.params);base_str=(base_str+<span style="color:#729fcf;font-weight:400">self</span>.hash(<span style="color:#729fcf;font-weight:400">self</span>.data)<span style="color:#000000;font-weight:700">if</span> <span style="color:#729fcf;font-weight:400">self</span>.data <span style="color:#000000;font-weight:700">else</span> base_str+<span style="color:#729fcf;font-weight:400">str</span>(<span style="color:#edd400;font-weight:400">&quot;0&quot;</span>*<span style="color:#edd400;font-weight:400">32</span>));base_str=(base_str+<span style="color:#729fcf;font-weight:400">self</span>.hash(<span style="color:#729fcf;font-weight:400">self</span>.cookies)<span style="color:#000000;font-weight:700">if</span> <span style="color:#729fcf;font-weight:400">self</span>.cookies <span style="color:#000000;font-weight:700">else</span> base_str+<span style="color:#729fcf;font-weight:400">str</span>(<span style="color:#edd400;font-weight:400">&quot;0&quot;</span>*<span style="color:#edd400;font-weight:400">32</span>));<span style="color:#000000;font-weight:700">return</span> base_str<br />    <span style="color:#000000;font-weight:700">def</span> <span style="color:#729fcf;font-weight:400">get_value</span>(<span style="color:#729fcf;font-weight:400">self</span>)-&gt;json:<span style="color:#000000;font-weight:700">return</span> <span style="color:#729fcf;font-weight:400">self</span>.encrypt(<span style="color:#729fcf;font-weight:400">self</span>.get_base_string())<br />    <span style="color:#000000;font-weight:700">def</span> <span style="color:#729fcf;font-weight:400">encrypt</span>(<span style="color:#729fcf;font-weight:400">self</span>,data:<span style="color:#729fcf;font-weight:400">str</span>)-&gt;json:<br />     unix,<span style="color:#729fcf;font-weight:400">len</span>,key,result,param_list=<span style="color:#729fcf;font-weight:400">int</span>(time.time()),<span style="color:#edd400;font-weight:400">0x14</span>,[<span style="color:#edd400;font-weight:400">0xDF</span>,<span style="color:#edd400;font-weight:400">0x77</span>,<span style="color:#edd400;font-weight:400">0xB9</span>,<span style="color:#edd400;font-weight:400">0x40</span>,<span style="color:#edd400;font-weight:400">0xB9</span>,<span style="color:#edd400;font-weight:400">0x9B</span>,<span style="color:#edd400;font-weight:400">0x84</span>,<span style="color:#edd400;font-weight:400">0x83</span>,<span style="color:#edd400;font-weight:400">0xD1</span>,<span style="color:#edd400;font-weight:400">0xB9</span>,<span style="color:#edd400;font-weight:400">0xCB</span>,<span style="color:#edd400;font-weight:400">0xD1</span>,<span style="color:#edd400;font-weight:400">0xF7</span>,<span style="color:#edd400;font-weight:400">0xC2</span>,<span style="color:#edd400;font-weight:400">0xB9</span>,<span style="color:#edd400;font-weight:400">0x85</span>,<span style="color:#edd400;font-weight:400">0xC3</span>,<span style="color:#edd400;font-weight:400">0xD0</span>,<span style="color:#edd400;font-weight:400">0xFB</span>,<span style="color:#edd400;font-weight:400">0xC3</span>],<span style="color:#edd400;font-weight:400">&quot;&quot;</span>,[]<br />     <span style="color:#000000;font-weight:700">for</span> i <span style="color:#000000;font-weight:700">in</span> <span style="color:#729fcf;font-weight:400">range</span>(<span style="color:#edd400;font-weight:400">0</span>,<span style="color:#edd400;font-weight:400">12</span>,<span style="color:#edd400;font-weight:400">4</span>):<br />      temp=data[<span style="color:#edd400;font-weight:400">8</span>*i:<span style="color:#edd400;font-weight:400">8</span>*(i+<span style="color:#edd400;font-weight:400">1</span>)]<br />      <span style="color:#000000;font-weight:700">for</span> j <span style="color:#000000;font-weight:700">in</span> <span style="color:#729fcf;font-weight:400">range</span>(<span style="color:#edd400;font-weight:400">4</span>):H = <span style="color:#729fcf;font-weight:400">int</span>(temp[j*<span style="color:#edd400;font-weight:400">2</span>:(j+<span style="color:#edd400;font-weight:400">1</span>)*<span style="color:#edd400;font-weight:400">2</span>],<span style="color:#edd400;font-weight:400">16</span>);param_list.append(H)<br />     param_list.extend([<span style="color:#edd400;font-weight:400">0x0</span>,<span style="color:#edd400;font-weight:400">0x6</span>,<span style="color:#edd400;font-weight:400">0xB</span>,<span style="color:#edd400;font-weight:400">0x1C</span>]);H=<span style="color:#729fcf;font-weight:400">int</span>(<span style="color:#729fcf;font-weight:400">hex</span>(<span style="color:#729fcf;font-weight:400">int</span>(unix)),<span style="color:#edd400;font-weight:400">16</span>);param_list.append((H&amp;<span style="color:#edd400;font-weight:400">0xFF000000</span>)&gt;&gt;<span style="color:#edd400;font-weight:400">24</span>);param_list.append((H&amp;<span style="color:#edd400;font-weight:400">0x00FF0000</span>)&gt;&gt;<span style="color:#edd400;font-weight:400">16</span>);param_list.append((H&amp;<span style="color:#edd400;font-weight:400">0x0000FF00</span>)&gt;&gt;<span style="color:#edd400;font-weight:400">8</span>);param_list.append((H&amp;<span style="color:#edd400;font-weight:400">0x000000FF</span>)&gt;&gt;<span style="color:#edd400;font-weight:400">0</span>);eor_result_list = []<br />     <span style="color:#000000;font-weight:700">for</span> A,B <span style="color:#000000;font-weight:700">in</span> <span style="color:#729fcf;font-weight:400">zip</span>(param_list,key):eor_result_list.append(A^B)<br />     <span style="color:#000000;font-weight:700">for</span> i <span style="color:#000000;font-weight:700">in</span> <span style="color:#729fcf;font-weight:400">range</span>(<span style="color:#729fcf;font-weight:400">len</span>):C=<span style="color:#729fcf;font-weight:400">self</span>.reverse(eor_result_list[i]);D=eor_result_list[(i + <span style="color:#edd400;font-weight:400">1</span>)%<span style="color:#729fcf;font-weight:400">len</span>];E=C^D;F=<span style="color:#729fcf;font-weight:400">self</span>.rbit_algorithm(E);H=((F^<span style="color:#edd400;font-weight:400">0xFFFFFFFF</span>)^<span style="color:#729fcf;font-weight:400">len</span>)&amp;<span style="color:#edd400;font-weight:400">0xFF</span>;eor_result_list[i]=H<br />     <span style="color:#000000;font-weight:700">for</span> param <span style="color:#000000;font-weight:700">in</span> eor_result_list:result+=<span style="color:#729fcf;font-weight:400">self</span>.hex_string(param)<br />     <span style="color:#000000;font-weight:700">return</span> {<span style="color:#edd400;font-weight:400">&quot;x-ss-req-ticket&quot;</span>:<span style="color:#729fcf;font-weight:400">str</span>(<span style="color:#729fcf;font-weight:400">int</span>(unix*<span style="color:#edd400;font-weight:400">1000</span>)),<span style="color:#edd400;font-weight:400">&quot;x-khronos&quot;</span>:<span style="color:#729fcf;font-weight:400">str</span>(<span style="color:#729fcf;font-weight:400">int</span>(unix)),<span style="color:#edd400;font-weight:400">&quot;x-gorgon&quot;</span>:(<span style="color:#edd400;font-weight:400">&quot;0404b0d30000&quot;</span>+result)}<br />    <span style="color:#000000;font-weight:700">def</span> <span style="color:#729fcf;font-weight:400">rbit_algorithm</span>(<span style="color:#729fcf;font-weight:400">self</span>, num):<br />     result,tmp_string= <span style="color:#edd400;font-weight:400">&quot;&quot;</span>,<span style="color:#729fcf;font-weight:400">bin</span>(num)[<span style="color:#edd400;font-weight:400">2</span>:]<br />     <span style="color:#000000;font-weight:700">while</span> <span style="color:#729fcf;font-weight:400">len</span>(tmp_string)&lt;<span style="color:#edd400;font-weight:400">8</span>:tmp_string=<span style="color:#edd400;font-weight:400">&quot;0&quot;</span>+tmp_string<br />     <span style="color:#000000;font-weight:700">for</span> i <span style="color:#000000;font-weight:700">in</span> <span style="color:#729fcf;font-weight:400">range</span>(<span style="color:#edd400;font-weight:400">0</span>,<span style="color:#edd400;font-weight:400">8</span>):result=result+tmp_string[<span style="color:#edd400;font-weight:400">7</span>-i]<br />     <span style="color:#000000;font-weight:700">return</span> <span style="color:#729fcf;font-weight:400">int</span>(result,<span style="color:#edd400;font-weight:400">2</span>)<br />    <span style="color:#000000;font-weight:700">def</span> <span style="color:#729fcf;font-weight:400">hex_string</span>(<span style="color:#729fcf;font-weight:400">self</span>,num):<br />     tmp_string=<span style="color:#729fcf;font-weight:400">hex</span>(num)[<span style="color:#edd400;font-weight:400">2</span>:]<br />     <span style="color:#000000;font-weight:700">if</span> <span style="color:#729fcf;font-weight:400">len</span>(tmp_string)&lt;<span style="color:#edd400;font-weight:400">2</span>:tmp_string=<span style="color:#edd400;font-weight:400">&quot;0&quot;</span>+tmp_string<br />     <span style="color:#000000;font-weight:700">return</span> tmp_string<br />    <span style="color:#000000;font-weight:700">def</span> <span style="color:#729fcf;font-weight:400">reverse</span>(<span style="color:#729fcf;font-weight:400">self</span>, num):tmp_string=<span style="color:#729fcf;font-weight:400">self</span>.hex_string(num);<span style="color:#000000;font-weight:700">return</span> <span style="color:#729fcf;font-weight:400">int</span>(tmp_string[<span style="color:#edd400;font-weight:400">1</span>:]+tmp_string[:<span style="color:#edd400;font-weight:400">1</span>],<span style="color:#edd400;font-weight:400">16</span>)<br />    </pre></div></p><p></p><p><h2>Define una clase llamada </h2><strong><code><h2>ttsign</h2></code></strong><h2>, que parece estar diseñada para generar una firma digital o un valor cifrado de solicitud, probablemente para interactuar con una API web, como TikTok o servicios similares que requieren tokens o firmas especiales.</h2></p><p><ol><li>1. <strong><h2>1. Constructor (</h2></strong><strong><code><h2>__init__</h2></code></strong><strong><h2>):</h2></strong></li></ol></p><p></p><p><div class="codebox"><pre><br /><span style="color:#000000;font-weight:700">def</span> <span style="color:#729fcf;font-weight:400">__init__</span>(<span style="color:#729fcf;font-weight:400">self</span>, params: <span style="color:#729fcf;font-weight:400">str</span>, data: <span style="color:#729fcf;font-weight:400">str</span>, cookies: <span style="color:#729fcf;font-weight:400">str</span>) -&gt; <span style="color:#ce5c00;font-weight:400">None</span>:<br />    <span style="color:#729fcf;font-weight:400">self</span>.params, <span style="color:#729fcf;font-weight:400">self</span>.data, <span style="color:#729fcf;font-weight:400">self</span>.cookies = params, data, cookies<br /></pre></div></p><p></p><p><h3>El constructor inicializa la clase con tres parámetros:</h3><h3></h3></p><p><h3></h3><ul><li><strong><code><h3>params</h3></code></strong><h3>: Los parámetros de la URL o de la solicitud.</h3></li><li><strong><code><h3>data</h3></code></strong><h3>: El cuerpo de datos (posiblemente de una petición POST).</h3></li><li><strong><code><h3>cookies</h3></code></strong><h3>: Las cookies asociadas a la sesión o solicitud.</h3></li></ul><h3></h3></p><p><h3></h3><h3></h3></p><p><h3>Estos tres elementos son comunes en solicitudes HTTP.</h3></p><p><ol><li>2. <strong><h2>2. </h2></strong><strong><code><h2>hash</h2></code></strong><strong><h2>:</h2></strong></li></ol></p><p></p><p><div class="codebox"><pre><br /><span style="color:#000000;font-weight:700">def</span> <span style="color:#729fcf;font-weight:400">hash</span>(<span style="color:#729fcf;font-weight:400">self</span>, data: <span style="color:#729fcf;font-weight:400">str</span>) -&gt; <span style="color:#729fcf;font-weight:400">str</span>:<br />    <span style="color:#000000;font-weight:700">return</span> <span style="color:#729fcf;font-weight:400">str</span>(hashlib.md5(data.encode()).hexdigest())<br /></pre></div></p><p></p><p><h3>Esta función toma una cadena de datos, la codifica y genera un </h3><strong><h3>hash MD5</h3></strong><h3> de esos datos.</h3></p><p><ol><li>3. <strong><h2>3. get_base_string:</h2></strong></li></ol></p><p></p><p><div class="codebox"><pre><br /><span style="color:#000000;font-weight:700">def</span> <span style="color:#729fcf;font-weight:400">get_base_string</span>(<span style="color:#729fcf;font-weight:400">self</span>) -&gt; <span style="color:#729fcf;font-weight:400">str</span>:<br />    base_str = <span style="color:#729fcf;font-weight:400">self</span>.hash(<span style="color:#729fcf;font-weight:400">self</span>.params)<br />    base_str = (base_str + <span style="color:#729fcf;font-weight:400">self</span>.hash(<span style="color:#729fcf;font-weight:400">self</span>.data) <span style="color:#000000;font-weight:700">if</span> <span style="color:#729fcf;font-weight:400">self</span>.data <span style="color:#000000;font-weight:700">else</span> base_str + <span style="color:#729fcf;font-weight:400">str</span>(<span style="color:#edd400;font-weight:400">&quot;0&quot;</span> * <span style="color:#edd400;font-weight:400">32</span>))<br />    base_str = (base_str + <span style="color:#729fcf;font-weight:400">self</span>.hash(<span style="color:#729fcf;font-weight:400">self</span>.cookies) <span style="color:#000000;font-weight:700">if</span> <span style="color:#729fcf;font-weight:400">self</span>.cookies <span style="color:#000000;font-weight:700">else</span> base_str + <span style="color:#729fcf;font-weight:400">str</span>(<span style="color:#edd400;font-weight:400">&quot;0&quot;</span> * <span style="color:#edd400;font-weight:400">32</span>))<br />    <span style="color:#000000;font-weight:700">return</span> base_str<br /></pre></div></p><p><ul><li>• <h3>• Esta función genera una cadena base utilizando el hash MD5 de los parámetros, los datos y las cookies.</h3></li><li><h3>Si no hay datos o cookies, se reemplazan por una cadena de 32 ceros.</h3></li></ul></p><p><ol><li>4. <strong><h2>4. get_value:</h2></strong></li></ol></p><p></p><p><div class="codebox"><pre><br /><span style="color:#000000;font-weight:700">def</span> <span style="color:#729fcf;font-weight:400">get_value</span>(<span style="color:#729fcf;font-weight:400">self</span>) -&gt; json:<br />    <span style="color:#000000;font-weight:700">return</span> <span style="color:#729fcf;font-weight:400">self</span>.encrypt(<span style="color:#729fcf;font-weight:400">self</span>.get_base_string())<br /></pre></div></p><p></p><p><h3>Llama a la función </h3><strong><code><h3>encrypt</h3></code></strong><h3> con la cadena base generada y devuelve un valor cifrado en formato JSON.</h3></p><p><ol><li>5. <strong><h2>5. </h2></strong><strong><code><h2>encrypt</h2></code></strong><strong><h2>:</h2></strong></li></ol></p><p></p><p><div class="codebox"><pre><br /><span style="color:#000000;font-weight:700">def</span> <span style="color:#729fcf;font-weight:400">encrypt</span>(<span style="color:#729fcf;font-weight:400">self</span>, data: <span style="color:#729fcf;font-weight:400">str</span>) -&gt; json:<br />    unix, <span style="color:#729fcf;font-weight:400">len</span>, key, result, param_list = <span style="color:#729fcf;font-weight:400">int</span>(time.time()), <span style="color:#edd400;font-weight:400">0x14</span>, [<span style="color:#edd400;font-weight:400">0xDF</span>, <span style="color:#edd400;font-weight:400">0x77</span>, <span style="color:#edd400;font-weight:400">0xB9</span>, <span style="color:#edd400;font-weight:400">0x40</span>, ...], <span style="color:#edd400;font-weight:400">&quot;&quot;</span>, []<br /></pre></div></p><p><ul><li>• <h3>• </h3><strong><code><h3>unix</h3></code></strong><h3>: Almacena el tiempo actual en formato UNIX (segundos desde 1970).</h3></li><li><strong><code><h3>key</h3></code></strong><h3>: Es una lista fija de valores hexadecimales que probablemente se usa como clave de cifrado.</h3></li><li><strong><code><h3>param_list</h3></code></strong><h3>: Se llenará con valores extraídos de los datos que serán luego procesados.</h3></li></ul><h3></h3></p><p><h3></h3><h3></h3></p><p><h3>El algoritmo de cifrado realiza los siguientes pasos:</h3><ul><li><h3>Divide la cadena base en bloques, toma valores hexadecimales y aplica operaciones XOR entre los valores y la clave.</h3></li><li><h3>Luego, estos resultados se procesan con </h3><strong><code><h3>rbit_algorithm</h3></code></strong><h3> y </h3><strong><code><h3>reverse</h3></code></strong><h3> para manipular bits y generar el valor final cifrado.</h3></li></ul><h3></h3></p><p><h3></h3><h3></h3></p><p><h3>El resultado final es una serie de valores que incluye:</h3><ul><li><strong><code><h3>x-ss-req-ticket</h3></code></strong><h3>: Tiempo en milisegundos.</h3></li><li><strong><code><h3>x-khronos</h3></code></strong><h3>: Marca de tiempo UNIX.</h3></li><li><strong><code><h3>x-gorgon</h3></code></strong><h3>: Un valor generado que parece ser una firma utilizada en algunas solicitudes API.</h3></li></ul></p><p><ol><li>6. <strong><h2>6. </h2></strong><strong><code><h2>rbit_algorithm</h2></code></strong><strong><h2>:</h2></strong></li></ol></p><p></p><p><div class="codebox"><pre><br /><span style="color:#000000;font-weight:700">def</span> <span style="color:#729fcf;font-weight:400">rbit_algorithm</span>(<span style="color:#729fcf;font-weight:400">self</span>, num):<br />    result, tmp_string = <span style="color:#edd400;font-weight:400">&quot;&quot;</span>, <span style="color:#729fcf;font-weight:400">bin</span>(num)[<span style="color:#edd400;font-weight:400">2</span>:]<br />    ...<br />    <span style="color:#000000;font-weight:700">return</span> <span style="color:#729fcf;font-weight:400">int</span>(result, <span style="color:#edd400;font-weight:400">2</span>)<br /></pre></div></p><p></p><p><h3>Reorganiza los bits de un número, invirtiendo el orden de los bits en un número binario.</h3></p><p><ol><li>7. <strong><h2>7. </h2></strong><strong><code><h2>hex_string</h2></code></strong><strong><h2>:</h2></strong></li></ol></p><p></p><p><div class="codebox"><pre><br /><span style="color:#000000;font-weight:700">def</span> <span style="color:#729fcf;font-weight:400">hex_string</span>(<span style="color:#729fcf;font-weight:400">self</span>, num):<br />    tmp_string = <span style="color:#729fcf;font-weight:400">hex</span>(num)[<span style="color:#edd400;font-weight:400">2</span>:]<br />    ...<br />    <span style="color:#000000;font-weight:700">return</span> tmp_string<br /></pre></div></p><p></p><p><h3>Convierte un número en su representación hexadecimal.</h3></p><p><ol><li>8. <strong><h2>8. </h2></strong><strong><code><h2>reverse</h2></code></strong><strong><h2>:</h2></strong></li></ol></p><p></p><p><div class="codebox"><pre><br /><span style="color:#000000;font-weight:700">def</span> <span style="color:#729fcf;font-weight:400">reverse</span>(<span style="color:#729fcf;font-weight:400">self</span>, num):<br />    tmp_string = <span style="color:#729fcf;font-weight:400">self</span>.hex_string(num)<br />    <span style="color:#000000;font-weight:700">return</span> <span style="color:#729fcf;font-weight:400">int</span>(tmp_string[<span style="color:#edd400;font-weight:400">1</span>:] + tmp_string[:<span style="color:#edd400;font-weight:400">1</span>], <span style="color:#edd400;font-weight:400">16</span>)<br /></pre></div></p><p></p><p><h3>Cambia el orden de los caracteres en la representación hexadecimal de un número y luego lo convierte de vuelta en un número entero.</h3></p></div>
</body>
</html>
