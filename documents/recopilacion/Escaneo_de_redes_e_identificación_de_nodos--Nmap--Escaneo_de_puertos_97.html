<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Escaneo de puertos</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Escaneo de puertos</h1><br/><p></p><p></p><p><strong><h1>¿Qué es un puerto?</h1></strong></p><p></p><p>Cuando nosotros tenemos dos computadores, dos ordenadores que quieren intercambiar información entre ellos.</p><p>Entonces nosotros podemos conectarlos formando una red.</p><p>Estos ordenadores pasarían a llamarse nodos de esa red y podemos intercambiar información que a priori serán una serie de cadenas de bits y que cuando llegan al sistema operativo del nodo de destino se interpretan en base a una serie de reglas estáticas que se denomina protocolo de red.</p><p></p><p></p><p>Para tratar de distinguir las conexiones que establecemos para intercambiar información con otro nodo en función de las aplicaciones que estamos utilizando, se inventó el concepto de puerto.</p><p></p><p>Un puerto es un numero que va a identificar una aplicación que está corriendo en el equipo y por lo tanto, si yo quiero mandar información que va dirigida a esa aplicación y que va a tener que interpretarla con un protocolo determinado, lo que hago es que le añado a mi paquete de red ese numerito que es el puerto.</p><p></p><p>De manera que cuando el nodo de destino recibe la información, la parsea y la analiza ve el puerto al que va dirigido y sabe a qué aplicación concretamente va a ir dirigida y por lo tanto, qué protocolo y qué reglas estáticas aplicar para interpretar esa información.</p><p></p><p><a href="https://nmap.org/book/man-port-scanning-techniques.html">https://nmap.org/book/man-port-scanning-techniques.html</a></p><p></p><p></p><p><strong><h3>Estados en los que pueden encontrarse los puertos:</h3></strong><ul><li><em><strong>open</strong></em></li></ul></p><p>Una aplicación está aceptando activamente conexiones TCP, data-gramas UDP o asociaciones SCTP en este puerto. Encontrar estos puertos suele ser el objetivo principal de la exploración de puertos. Las personas preocupadas por la seguridad saben que cada puerto abierto es una vía de ataque. Los atacantes y los evaluadores de penetración desean explotar los puertos abiertos, mientras que los administradores intentan cerrarlos o protegerlos con firewalls sin obstaculizar a los usuarios legítimos. Los puertos abiertos también son interesantes para exploraciones no relacionadas con la seguridad porque muestran servicios disponibles para su uso en la red.</p><p><ul><li><em><strong>closed</strong></em></li></ul></p><p>Un puerto cerrado es accesible (recibe y responde a paquetes de sonda de Nmap), pero no hay ninguna aplicación escuchando en él. Pueden ser útiles para mostrar que un host está activo en una dirección IP (detección de host o exploración de ping), y como parte de la detección de sistemas operativos. Debido a que los puertos cerrados son alcanzables, puede valer la pena escanear más tarde en caso de que algunos se abran. Los administradores pueden querer considerar bloquear dichos puertos con un firewall. Entonces aparecerían en el estado filtrado, que se discute a continuación.</p><p><ul><li><em><strong>filtered</strong></em></li></ul></p><p>Nmap no puede determinar si el puerto está abierto porque el filtrado de paquetes impide que sus sondas lleguen al puerto. El filtrado podría provenir de un dispositivo de firewall dedicado, reglas de enrutador o software de firewall basado en el host. Estos puertos frustran a los atacantes porque proporcionan muy poca información. A veces responden con mensajes de error ICMP como el tipo 3 código 13 (destino inaccesible: comunicación administrativamente prohibida), pero los filtros que simplemente descartan las sondas sin responder son mucho más comunes. Esto obliga a Nmap a volver a intentarlo varias veces solo por si acaso la sonda fue descartada debido a la congestión de la red en lugar de ser filtrada. Esto ralentiza considerablemente el escaneo..</p><p><ul><li><em><strong>unfiltered</strong></em></li></ul></p><p>El estado no filtrado significa que un puerto es accesible, pero Nmap no puede determinar si está abierto o cerrado. Solo el escaneo ACK, que se utiliza para mapear conjuntos de reglas de firewall, clasifica los puertos en este estado. Escanear puertos no filtrados con otros tipos de escaneo como escaneo de ventana, escaneo SYN o escaneo FIN, puede ayudar a determinar si el puerto está abierto.</p><p><ul><li><em><strong>open|filtered</strong></em></li></ul></p><p>Nmap coloca los puertos en este estado cuando no puede determinar si un puerto está abierto o filtrado. Esto ocurre para tipos de escaneo en los que los puertos abiertos no dan respuesta. La falta de respuesta también podría significar que un filtro de paquetes descartó la sonda o cualquier respuesta que generara. Por lo tanto, Nmap no sabe con certeza si el puerto está abierto o siendo filtrado. Los escaneos UDP, de protocolo IP, FIN, NULL y Xmas clasifican los puertos de esta manera.</p><p><ul><li><em><strong>closed|filtered</strong></em></li></ul></p><p>Este estado se utiliza cuando Nmap no puede determinar si un puerto está cerrado o filtrado. Solo se utiliza para el escaneo de inactividad de ID de IP.</p><p></p><p></p><p></p><p></p><p><strong><h3>Comandos:</h3></strong></p><p><ul><li><strong>-sS (TCP SYN scan)</strong></p><p></li></ul><div class="codebox"><pre><br /><span style="color:#000000;font-weight:700">sudo</span> nmap -sS 192.168.20.128 <span style="color:#000000;font-weight:700">|</span> 192.168.20.0<span style="color:#000000;font-weight:700">/</span>24 <span style="color:#000000;font-weight:700">|</span> 192.168.20.120-130</pre></div></p><p></p><p>Este escaneo lo que va a hacer es realizar un escaneo o un análisis de los puertos que tiene ese sistema, haciendo peticiones a cada uno de los puertos del sistema de manera individual.</p><p></p><p>Lo hace mediante una conexión TCP, pero al contrario de lo que habíamos visto en situaciones anteriores en las que se establecía toda la conexión completa lo que hace es dejar el handshake a medias.</p><p></p><p><ul><li><strong>-v --reason </strong></li></ul></p><p>Para obtener más información sobre el escaneo y los motivos por los que el puerto está abierto.</p><p><ul><li><strong>-oX --stylesheet=&quot;https://svn.nmap.org/nmap/docs/nmap.xls&quot;</strong></li></ul></p><p>Exportar los resultados con plantilla</p><p></p><p><div class="codebox"><pre><br /><span style="color:#000000;font-weight:700">sudo</span> nmap -sS -v --reason -oX --stylesheet=<span style="color:#edd400;font-weight:400">&quot;https://svn.nmap.org/nmap/docs/nmap.xls&quot;</span> 192.168.20.128 </pre></div></p><p></p><p><ul><li><strong>-sT (TCP connect scan)</strong></p><p></li></ul><div class="codebox"><pre><br />nmap -sT 192.168.20.128</pre></div></p><p></p><p>Para saber si el host esta app sí que hace el mismo descubrimiento mediante a ARP pero esta vez si completa el three way handshake.</p><p><ul><li><strong>-sU (UDP scans) </strong></p><p></li></ul><div class="codebox"><pre><br /><span style="color:#000000;font-weight:700">sudo</span> nmap -sU 192.168.20.128</pre></div></p><p>Cuando nosotros ejecutamos esta petición, lo que hacen NMAP es que manda un paquete UDP que no tiene ni siquiera contenido a ese puerto para ver si hay algo ahí corriendo.</p><p></p><p></p><p></p><p></p><p><strong><h3>Asegurar qué servicio se está ejecutando en esos puertos</h3></strong><h3>.</h3></p><p><a href="https://nmap.org/book/man-version-detection.html">https://nmap.org/book/man-version-detection.html</a></p><p></p><p><strong>-sV (Version detection)  </strong></p><p><div class="codebox"><pre><br /><span style="color:#000000;font-weight:700">sudo</span> nmap -sV 192.168.20.128</pre></div></p><p></p><p>Realiza el escaneo activo al igual que antes pero determina tambíen la versión del servicio que está ofreciendo ese puerto.</p><p>Al igual que con -sS no termina el three way handshake.</p><p></p><p></p><p>     </p><p></p></div>
</body>
</html>
