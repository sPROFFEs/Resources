<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>ICMP (primeros pasos)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>ICMP (primeros pasos)</h1><br/><p></p><p>Primero como se forma un paquete ICMP:</p><p></p><p><img src="images/138-1.png" alt="images/138-1.png" /> </p><p><ul><li>Ethernet: dirección MAC e IP </li><li>ICMP: varios campos entre los que se incluye uno de data que se reenvía en el protocolo para verificar las respuestas.</li></ul></p><p></p><p><img src="images/138-2.png" alt="images/138-2.png" /></p><p></p><p></p><p>El caso es modificar el paquete ICMP en tránsito mediante Polymorph.</p><p></p><p>Para esto nos situamos en medio de la comunicación mediante ARP spoofing por ejemplo.</p><p></p><p>Una cosa a tener en cuenta a la hora de realizar conexiones entre nodos en red virtual es que se omite el uso de un router como tal, se establecen conexiones de punto a punto.</p><p></p><p><img src="images/138-3.png" alt="images/138-3.png" /></p><p></p><p>Iniciamos polymorph e indicamos el objetivo y el gateway o puerta de enlace que en este caso es la máquina ubuntu.</p><p></p><p><img src="images/138-4.png" alt="images/138-4.png" /></p><p>ARP spoofing ya está establecido.</p><p></p><p><img src="images/138-5.png" alt="images/138-5.png" /></p><p></p><p>Ahora el paquete da 1 salto más hasta llegar a la máquina objetivo.</p><p></p><p>Capturamos paquetes ICMP</p><p></p><p><img src="images/138-6.png" alt="images/138-6.png" /></p><p></p><p><img src="images/138-7.png" alt="images/138-7.png" /></p><p></p><p>Pulsamos TAB y luego show</p><p></p><p><img src="images/138-8.png" alt="images/138-8.png" /></p><p></p><p>Podemos abrir los paquetes en Wireshark.</p><p></p><p><img src="images/138-9.png" alt="images/138-9.png" /></p><p></p><p>Seleccionamos el template</p><p></p><p><img src="images/138-10.png" alt="images/138-10.png" /></p><p></p><p>Podemos visualizar el contenido </p><p><img src="images/138-11.png" alt="images/138-11.png" /></p><p></p><p>Ahora tenemos esta plantilla correspondiente al paquete que vamos a modificar en tiempo real.</p><p></p><p></p><p></p><p>Añadimos una función en python.</p><p></p><p><img src="images/138-12.png" alt="images/138-12.png" /></p><p></p><p>Nombre de la función y editor de texto.</p><p></p><p><img src="images/138-13.png" alt="images/138-13.png" /></p><p></p><p>Ejecuta el editor con esa plantilla.</p><p></p><p>Con esto básicamente podremos sobre cualquier protocolo de red modificar y ejecutar el código que introduzcamos en tiempo real.</p><p></p><p>Por ejemplo un código que cada vez que se intercepte un paquete ICMP lo avise por pantalla.</p><p></p><p><img src="images/138-14.png" alt="images/138-14.png" /></p><p></p><p>Para ver las funciones añadidas.</p><p></p><p><img src="images/138-15.png" alt="images/138-15.png" /></p><p></p><p>Interceptamos.</p><p></p><p><img src="images/138-16.png" alt="images/138-16.png" /></p><p></p><p>Hacemos una prueba.</p><p></p><p><img src="images/138-17.png" alt="images/138-17.png" /></p><p></p><p><img src="images/138-18.png" alt="images/138-18.png" /></p><p></p><p></p><p>Por ejemplo para modificar el paquete.</p><p></p><p><img src="images/138-19.png" alt="images/138-19.png" /></p><p></p><p>Añadimos que modifique los últimos 8 dígitos del paquete en su parámetro data.</p><p></p><p><img src="images/138-20.png" alt="images/138-20.png" /></p><p></p><p><img src="images/138-21.png" alt="images/138-21.png" /></p><p></p><p><img src="images/138-22.png" alt="images/138-22.png" /></p><p></p><p>Como solo se modifica el paquete replay y no el response al no coincidir la cadena de datos la máquina interpreta que no se está realizando la conexión.</p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p></div>
</body>
</html>
