<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>BLOODHOUND</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>BLOODHOUND</h1><br/><p><h1>Probablemente la herramienta más </h1>versátil.</p><p></p><p>Además de una herramienta de recopilación sirve como herramienta de análisis de vulnerabilidades.</p><p></p><p>Se basa en la teoría de grafos, recaudando toda la información de los objetos del dominio y los representa en forma de grafos con sus realaciones.</p><p></p><p><h3>https://github.com/BloodHoundAD/BloodHound</h3></p><p></p><p>Sus componentes principales son dos&gt;</p><p><ul><li>Servidor o aplicación principal para representar los objetos y sus relaciones</li><li>Collectors; módulos que debemos ejecutar en la máquina unida a dominio para que recopile la información y genere el fichero.</li></ul></p><p></p><p><div class="codebox"><pre><br /><span style="color:#000000;font-weight:700">sudo</span> apt <span style="color:#000000;font-weight:700">install</span> bloodhound</pre></div></p><p></p><p>Puesto que se basa en una base de datos no relacional basada en grafos que se denomina neo4j:</p><p></p><p><div class="codebox"><pre><br /><span style="color:#000000;font-weight:700">sudo</span> neo4j console</pre></div></p><p></p><p><img src="images/19-1.png" alt="images/19-1.png" /></p><p></p><p>Vemos que crea un servicio en el puerto 7687</p><p></p><p>En la interfaz web usamos las credenciales por defecto neo4j y cambiamos la contraseña.</p><p></p><p>ejecutamos </p><p></p><p><div class="codebox"><pre><br />bloodhound</pre></div></p><p></p><p><img src="images/19-2.png" alt="images/19-2.png" /></p><p></p><p>Una vez en la interfaz para poder cargar los datos necesitamos ejecutar los collectors en la maquina dentro del dominio así que copiamos en este caso el script ps1 <a href="https://raw.githubusercontent.com/BloodHoundAD/BloodHound/master/Collectors/SharpHound.ps1">https://raw.githubusercontent.com/BloodHoundAD/BloodHound/master/Collectors/SharpHound.ps1</a></p><p></p><p>Creamos documento de texto...guardar como...bloodhound.ps1...</p><p></p><p>En este caso windows defender no detecta el script como malicioso pero en versiones posteriores o si se tiene un buen EDR es posible que lo bloquee.</p><p></p><p><div class="codebox"><pre><br />. .<span style="color:#000000;font-weight:700">\</span>bloodhound.ps1</pre></div></p><p></p><p><img src="images/19-3.png" alt="images/19-3.png" /></p><p></p><p>El archivo por defecto esta en la carpeta del usuario empleado1: C:\Users\empleado1</p><p></p><p><img src="images/19-4.png" alt="images/19-4.png" /></p><p></p><p>Necesitamos el zip en la maquina kali</p><p></p><p>Una vez hecho simplemente arrastramos el zip a la interfaz Bloodhound</p><p></p><p><img src="images/19-5.png" alt="images/19-5.png" /></p><p></p><p><img src="images/19-6.png" alt="images/19-6.png" /></p><p></p><p>Desde aquí podemos analizar las relaciones, permisos, atributos, etc </p><p></p><p>Pero lo más interesante de BloodHound es el análisis que ya trae implementado porque al estar basado en ese tipo de base de datos no relacional permite hacer querys complejos y representarlas.</p><p><img src="images/19-7.png" alt="images/19-7.png" /></p><p></p><p><img src="images/19-8.png" alt="images/19-8.png" /></p><p></p><p><img src="images/19-9.png" alt="images/19-9.png" /></p><p></p><p><img src="images/19-10.png" alt="images/19-10.png" /></p><p></p><p><img src="images/19-11.png" alt="images/19-11.png" /></p><p></p><p></p><p>Ademas de las querys por defecto en la comunidad se encuentran algunas hechas por los usuarios:</p><p></p><p><h3>https://github.com/hausec/Bloodhound-Custom-Queries</h3></p><p></p><p><h3>https://github.com/CompassSecurity/BloodHoundQueries</h3></p><p></p><p><h3>https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/bloodhound</h3></p><p></p><p></p><p></p><p></p><p></p></div>
</body>
</html>
