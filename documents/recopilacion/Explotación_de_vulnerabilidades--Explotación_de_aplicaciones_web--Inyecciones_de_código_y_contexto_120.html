<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Inyecciones de código y contexto</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Inyecciones de código y contexto</h1><br/><p></p><p></p><p>De manera general, la mayoría de las vulnerabilidades que vamos a encontrarnos cuando nosotros tenemos como objetivo una aplicación web, van a ser vulnerabilidades que tienen que ver con la inyección de código.</p><p></p><p>Por lo tanto, para que pueda haber una inyección de código, tiene que haber algún campo dentro de la página web en el que nosotros podamos interactuar con esa aplicación objetivo.</p><p></p><p>Si nos estuviésemos enfrentando a una página estática o una página web que no tiene ningún punto de inyección, que no tiene ninguna manera con la que un usuario puede interactuar con ella, simplemente es una página que está mostrando algo, pero no tiene ni formularios, probablemente no vayamos a encontrar vulnerabilidades web en esa página y lo mejor sería afrontar el ataque desde el punto de vista de las vulnerabilidades que puede tener el sistema que alberga esa página.</p><p></p><p>Por ejemplo, en mutillidae:</p><p></p><p><img src="images/120-1.png" alt="images/120-1.png" /></p><p></p><p>Se muestran campos de entrada para hacer login, sin embargo hay más cosas que no se muestran únicamente en la interfaz.</p><p></p><p>Si interceptamos con BurpSuite:</p><p></p><p><img src="images/120-2.png" alt="images/120-2.png" /></p><p></p><p>Vemos varios campos de inyección como los de la URL por ser una petición GET.</p><p>Además de las cabeceras de información vemos las cookies que es potencialmente otro punto.</p><p></p><p></p><p>Normalmente vamos a tener 3 puntos de inyección en una petición:<ol><li>Parámetros que leven la URL.</li><li>Parámetros en el cuerpo o body de la petición.</li><li>Cookies.</li></ol></p><p></p><p>Lo que vamos a tratar de hacer es inyectar valores en estos puntos que consigan interactuar con la aplicación de destino y explotar algún problema de seguridad.</p><p></p><p>Lo que diferencia un fallo de seguridad de otro fallo de seguridad; por ejemplo, un SQL inyección de un crossite scripting es el contexto en el que estamos realizando esa inyección de código.</p><p></p><p>Otros conceptos básicos y necesarios son:</p><p><ul><li><strong>Canario</strong>:</li></ul></p><p>   Para ver cómo responde el servidor y donde se ha realizado la inyección de código utilizamos una palabra clave que metemos para que cuando se reciba la respuesta del servidor podamos buscar en el código donde se ha inyectado nuestro código.</p><p>   Es importante que sea sencillo, letras y números nada de caracteres especiales.</p><p>  </p><p>   Por ejemplo:</p><p>   <img src="images/120-3.png" alt="images/120-3.png" /></p><p>   </p><p>   <img src="images/120-4.png" alt="images/120-4.png" /></p><p>   </p><p>   Esto indica que un parámetro que nosotros le estamos indicando el servidor lo está usando para para inyectarlo en otro documento que nos devuelve.</p><p>   <ul><li><strong>Contexto</strong>:</li></ul></p><p>   Volviendo con el concepto anterior y sabiendo que el canario aparece debemos tener en cuenta en que contexto aparece.</p><p>   En el caso de arriba lo hace como texto HTML.</p><p>   Sabiendo el contexto ya podemos empezar a pensar como interferir en el comportamiento de esa aplicación.</p><p>   </p><p>  Por ejemplo: <img src="images/120-5.png" alt="images/120-5.png" /></p><p>   <img src="images/120-6.png" alt="images/120-6.png" /></p><p>   <img src="images/120-7.png" alt="images/120-7.png" /></p><p>   </p><p>   Si pasamos parámetros de script como es lo más normal:</p><p>   </p><p>   <img src="images/120-8.png" alt="images/120-8.png" /></p><p>   Lo podemos codificar en URL </p><p>   <img src="images/120-9.png" alt="images/120-9.png" /></p><p>   </p><p>   <img src="images/120-10.png" alt="images/120-10.png" /></p><p>   </p><p>   <img src="images/120-11.png" alt="images/120-11.png" /></p><p>   </p><p>   </p></div>
</body>
</html>
