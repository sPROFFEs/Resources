<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Fuzzing</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Fuzzing</h1><br/><p><strong><h1>¿En qué consiste?</h1></strong></p><p></p><p>Estas técnicas se basan en enviar diferentes inputs a una aplicación web o software para ver como responde.</p><p></p><p>Cogemos un diccionario de palabras raras o mal formadas con caracteres etc y se van a ir mandando a diferentes campos de entrada en la aplicación.</p><p></p><p>El objetivo principal en Hacking suele ser “romper” la aplicación, dejarla fuera de disponibilidad lo que significa que en algún lado se está provocando una excepción que no es controlada en el código de la aplicación.</p><p></p><p>Otro motivo puede ser encontrar elementos ocultos.</p><p></p><p></p><p><h1>WFuzz:</h1></p><p></p><p><a href="https://github.com/xmendez/wfuzz">https://github.com/xmendez/wfuzz</a></p><p></p><p><h1>FFUF:</h1></p><p></p><p><a href="https://github.com/ffuf/ffuf">https://github.com/ffuf/ffuf</a></p><p></p><p>Viene por defecto en Kali.</p><p></p><p>Podemos realizar descubrimiento de recursos como con Gobuster:</p><p></p><p><div class="codebox"><pre><br />ffuf -u http<span style="color:#000000;font-weight:700">://</span>192.168.20.133<span style="color:#000000;font-weight:700">:</span>8080<span style="color:#000000;font-weight:700">/</span>FUZZ -w <span style="color:#000000;font-weight:700">/</span>home<span style="color:#000000;font-weight:700">/</span>kali<span style="color:#000000;font-weight:700">/</span>Desktop<span style="color:#000000;font-weight:700">/</span>SecLists<span style="color:#000000;font-weight:700">/</span>Discovery<span style="color:#000000;font-weight:700">/</span>Web-Content<span style="color:#000000;font-weight:700">/</span>directory-list-2.3-small.txt</pre></div></p><p><img src="images/55-1.png" alt="images/55-1.png" /></p><p></p><p>Para poder ver las peticiones que hace FFUZZ podemos proxificar la petición por ejemplo con BurpSuite.</p><p></p><p><img src="images/55-2.png" alt="images/55-2.png" /></p><p></p><p><img src="images/55-3.png" alt="images/55-3.png" /></p><p></p><p>Y en FFUF indicamos el proxy:</p><p></p><p><div class="codebox"><pre><br />ffuf -u http<span style="color:#000000;font-weight:700">://</span>192.168.20.133<span style="color:#000000;font-weight:700">:</span>8080<span style="color:#000000;font-weight:700">/</span>FUZZ -w <span style="color:#000000;font-weight:700">/</span>home<span style="color:#000000;font-weight:700">/</span>kali<span style="color:#000000;font-weight:700">/</span>Desktop<span style="color:#000000;font-weight:700">/</span>SecLists<span style="color:#000000;font-weight:700">/</span>Discovery<span style="color:#000000;font-weight:700">/</span>Web-Content<span style="color:#000000;font-weight:700">/</span>directory-list-2.3-small.txt -x http<span style="color:#000000;font-weight:700">://</span>127.0.0.1<span style="color:#000000;font-weight:700">:</span>4444</pre></div></p><p></p><p></p><p>Si queremos que además realice el fuzzing no solo en la raíz que le indiquemos sino que además recorra de nuevo todo lo que encuentre con todos los parámetros del diccionario:</p><p></p><p><div class="codebox"><pre><br />ffuf -u http<span style="color:#000000;font-weight:700">://</span>192.168.20.133<span style="color:#000000;font-weight:700">:</span>8080<span style="color:#000000;font-weight:700">/</span>FUZZ -w <span style="color:#000000;font-weight:700">/</span>home<span style="color:#000000;font-weight:700">/</span>kali<span style="color:#000000;font-weight:700">/</span>Desktop<span style="color:#000000;font-weight:700">/</span>SecLists<span style="color:#000000;font-weight:700">/</span>Discovery<span style="color:#000000;font-weight:700">/</span>Web-Content<span style="color:#000000;font-weight:700">/</span>directory-list-2.3-small.txt -recursion</pre></div></p><p></p><p>Esto hace una identificación de los apartados principales que les responde, luego realiza de nuevo apartado por apartado lo mismo.</p><p></p><p>Podemos especificar que busque un archivo específico:</p><p></p><p><div class="codebox"><pre><br />ffuf -u http<span style="color:#000000;font-weight:700">://</span>192.168.20.133<span style="color:#000000;font-weight:700">:</span>8080<span style="color:#000000;font-weight:700">/</span>FUZZ -w <span style="color:#000000;font-weight:700">/</span>home<span style="color:#000000;font-weight:700">/</span>kali<span style="color:#000000;font-weight:700">/</span>Desktop<span style="color:#000000;font-weight:700">/</span>SecLists<span style="color:#000000;font-weight:700">/</span>Discovery<span style="color:#000000;font-weight:700">/</span>Web-Content<span style="color:#000000;font-weight:700">/</span>directory-list-2.3-small.txt -recursion -e .png</pre></div></p><p></p><p></p><p></p><p></p><p>Otra cosa muy interesante es el uso de varios diccionarios de manera simultánea.</p><p></p><p><div class="codebox"><pre><br />ffuf -u http<span style="color:#000000;font-weight:700">://</span>192.168.20.133<span style="color:#000000;font-weight:700">:</span>8080<span style="color:#000000;font-weight:700">/</span>wordlist1<span style="color:#000000;font-weight:700">/</span>wordlist2 -w <span style="color:#000000;font-weight:700">/</span>home<span style="color:#000000;font-weight:700">/</span>kali<span style="color:#000000;font-weight:700">/</span>Desktop<span style="color:#000000;font-weight:700">/</span>SecLists<span style="color:#000000;font-weight:700">/</span>Discovery<span style="color:#000000;font-weight:700">/</span>Web-Content<span style="color:#000000;font-weight:700">/</span>directory-list-2.3-small.txt<span style="color:#000000;font-weight:700">:</span>wordlist1 <span style="color:#000000;font-weight:700">/</span>home<span style="color:#000000;font-weight:700">/</span>kali<span style="color:#000000;font-weight:700">/</span>Desktop<span style="color:#000000;font-weight:700">/</span>SecLists<span style="color:#000000;font-weight:700">/</span>Discovery<span style="color:#000000;font-weight:700">/</span>Web-Content<span style="color:#000000;font-weight:700">/</span>directory-list-1.0.txt<span style="color:#000000;font-weight:700">:</span>wordlist2</pre></div></p><p></p><p></p><p></p><p>También podemos inyectar estas palabras en otros apartados del código fuente y no únicamente en el GET:</p><p></p><p>Con burpsuite vamos a interceptar una página como la siguiente:</p><p></p><p><img src="images/55-4.png" alt="images/55-4.png" /></p><p></p><p><img src="images/55-5.png" alt="images/55-5.png" /></p><p></p><p>Lo copiamos a un archivo.</p><p></p><p><img src="images/55-6.png" alt="images/55-6.png" /></p><p></p><p>Modificamos los apartados de usuario y contraseña en los que podemos indicar que utilice dos diccionarios uno de usuarios y otro de contraseñas:</p><p></p><p><img src="images/55-7.png" alt="images/55-7.png" /></p><p></p><p></p><p></p><p><div class="codebox"><pre><br />ffuf -request request_post -w <span style="color:#000000;font-weight:700">/</span>home<span style="color:#000000;font-weight:700">/</span>kali<span style="color:#000000;font-weight:700">/</span>Desktop<span style="color:#000000;font-weight:700">/</span>SecLists<span style="color:#000000;font-weight:700">/</span>Passwords<span style="color:#000000;font-weight:700">/</span>2020-200_most_used_passwords.txt -x http<span style="color:#000000;font-weight:700">://</span>127.0.0.1<span style="color:#000000;font-weight:700">:</span>4444</pre></div></p><p></p><p><img src="images/55-8.png" alt="images/55-8.png" /></p><p></p><p></p><p></p><p></p><p>Lo interesante en el fuzzing lo más interesante es intentar romper el servicio:</p><p></p><p>Podemos utilizar un programa llamado Radamsa</p><p></p><p><a href="https://gitlab.com/akihe/radamsa">https://gitlab.com/akihe/radamsa</a></p><p></p><p>Muta una entrada mediante diferentes técnicas de forma que introducimos una palabra cualquiera y lo va mutando metiendo caracteres raros para poder explotar la aplicación.</p><p></p><p><div class="codebox"><pre><br /> $ <span style="color:#888a85;font-weight:400"># please please please fuzz your programs. here is one way to get data for it:</span><br /> $ <span style="color:#000000;font-weight:700">sudo</span> apt-get <span style="color:#000000;font-weight:700">install</span> <span style="color:#000000;font-weight:700">gcc</span> <span style="color:#000000;font-weight:700">make</span> git <span style="color:#000000;font-weight:700">wget</span><br /> $ git clone https<span style="color:#000000;font-weight:700">://</span>gitlab.com<span style="color:#000000;font-weight:700">/</span>akihe<span style="color:#000000;font-weight:700">/</span>radamsa.git <span style="color:#000000;font-weight:700">&amp;&amp;</span> <span style="color:#000000;font-weight:700">cd</span> radamsa <span style="color:#000000;font-weight:700">&amp;&amp;</span> <span style="color:#000000;font-weight:700">make</span> <span style="color:#000000;font-weight:700">&amp;&amp;</span> <span style="color:#000000;font-weight:700">sudo</span> <span style="color:#000000;font-weight:700">make</span> <span style="color:#000000;font-weight:700">install</span><br /> $ <span style="color:#000000;font-weight:700">echo</span> <span style="color:#edd400;font-weight:400">&quot;HAL 9000&quot;</span> <span style="color:#000000;font-weight:700">|</span> radamsa<br /></pre></div></p><p><div class="codebox"><pre><br /> $ git clone https<span style="color:#000000;font-weight:700">://</span>gitlab.com<span style="color:#000000;font-weight:700">/</span>akihe<span style="color:#000000;font-weight:700">/</span>radamsa.git<br /> $ <span style="color:#000000;font-weight:700">cd</span> radamsa<br /> $ <span style="color:#000000;font-weight:700">make</span><br /> $ <span style="color:#000000;font-weight:700">sudo</span> <span style="color:#000000;font-weight:700">make</span> <span style="color:#000000;font-weight:700">install</span> <span style="color:#888a85;font-weight:400"># optional, you can also just grab bin/radamsa</span><br /> $ radamsa --help<br /></pre></div></p><p></p><p>Una vez instalado en el directorio bin&gt;</p><p></p><p><div class="codebox"><pre><br /><span style="color:#000000;font-weight:700">echo</span> <span style="color:#edd400;font-weight:400">&quot;test&quot;</span> <span style="color:#000000;font-weight:700">|</span> radamsa </pre></div></p><p></p><p><img src="images/55-9.png" alt="images/55-9.png" /></p><p></p><p>Otro uso:</p><p></p><p><div class="codebox"><pre><br /><span style="color:#000000;font-weight:700">echo</span> <span style="color:#edd400;font-weight:400">&quot;test&quot;</span> &gt; texto.txt<br />radamsa texto.txt</pre></div></p><p></p><p></p><p>En combinación con ffuf:</p><p></p><p><div class="codebox"><pre><br />ffuf -request <span style="color:#000000;font-weight:700">/</span>home<span style="color:#000000;font-weight:700">/</span>kali<span style="color:#000000;font-weight:700">/</span>Desktop<span style="color:#000000;font-weight:700">/</span>request_post --input-cmd <span style="color:#edd400;font-weight:400">&#39;radamsa /home/kali/Desktop/texto.txt&#39;</span> -x http<span style="color:#000000;font-weight:700">://</span>127.0.0.1<span style="color:#000000;font-weight:700">:</span>4444</pre></div></p><p></p><p><img src="images/55-10.png" alt="images/55-10.png" /></p><p></p><p>Por defecto ffuf limita las peticiones a 100 pero se puede modificar:</p><p></p><p><div class="codebox"><pre><br />ffuf -request <span style="color:#000000;font-weight:700">/</span>home<span style="color:#000000;font-weight:700">/</span>kali<span style="color:#000000;font-weight:700">/</span>Desktop<span style="color:#000000;font-weight:700">/</span>request_post --input-cmd <span style="color:#edd400;font-weight:400">&#39;radamsa /home/kali/Desktop/texto.txt&#39;</span> -x http<span style="color:#000000;font-weight:700">://</span>127.0.0.1<span style="color:#000000;font-weight:700">:</span>4444 -input-num 1000</pre></div></p><p></p><p></p><p>Si lo que buscamos son status code concretos podemos filtrarlos con algunas opciones de ffuf:</p><p></p><p><div class="codebox"><pre><br />ffuf -h</pre></div></p><p></p><p></p><p></p></div>
</body>
</html>
