<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Pesidious</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Pesidious</h1><br/><p></p><p>Se trata de una aplciación basada en machine learning para ofuscar binarios maliciosos para ser menos detectados por soluciones antivirus.</p><p></p><p><a href="https://github.com/CyberForce/Pesidious">https://github.com/CyberForce/Pesidious</a></p><p></p><p>La instalación es muy sensible debido a las dependencias que utiliza por lo que lo más óptimo sería instalar una máquina linux limpia y hacer la instalación únicamente de esta herramienta.</p><p></p><p>Con esto claro comenzamos:</p><p></p><p><div class="codebox"><pre><br />git clone https<span style="color:#000000;font-weight:700">://</span>github.com<span style="color:#000000;font-weight:700">/</span>CyberForce<span style="color:#000000;font-weight:700">/</span>Pesidious</pre></div></p><p></p><p>Instalamos python y aquí comienzan los problemas y motivos de la instalación aislada ya que utiliza python 3.6 y no otro.</p><p></p><p>Añadimos repositorio de versiones antiguas python.</p><p></p><p><div class="codebox"><pre><br /><span style="color:#000000;font-weight:700">sudo</span> add-apt-repository ppa<span style="color:#000000;font-weight:700">:</span>deadsnakes<span style="color:#000000;font-weight:700">/</span>ppa<br /><span style="color:#000000;font-weight:700">sudo</span> apt-get update<br /></pre></div></p><p></p><p>Instalamos python y pip</p><p></p><p><div class="codebox"><pre><br /><span style="color:#000000;font-weight:700">sudo</span> apt-get <span style="color:#000000;font-weight:700">install</span> python3.6<br />curl https<span style="color:#000000;font-weight:700">://</span>bootstrap.pypa.io<span style="color:#000000;font-weight:700">/</span>get-pip.py <span style="color:#000000;font-weight:700">|</span> <span style="color:#000000;font-weight:700">sudo</span> -H python3.6<br /></pre></div></p><p></p><p>En el directorio de Pesidious modificamos lo siguiente:</p><p></p><p><div class="codebox"><pre><br />pico pip_requirements<span style="color:#000000;font-weight:700">/</span>requirements.txt</pre></div></p><p></p><p>Debemos encontrar la línea donde indique la versión de pygments y poner la 2.6.0</p><p></p><p><img src="images/151-1.png" alt="images/151-1.png" /></p><p></p><p>Instalamos requerimientos:</p><p></p><p><div class="codebox"><pre><br />python3.6 -m pip <span style="color:#000000;font-weight:700">install</span> -r pip_requirements<span style="color:#000000;font-weight:700">/</span>requirements.txt</pre></div></p><p></p><p>Si no hay problemas debería estar funcionando.</p><p></p><p></p><p></p><p><h1>Uso de </h1><strong><h1>Pesidious</h1></strong>.</p><p></p><p>Necesitamos el binario con malware que en este caso será un putty.exe con un backdoor creado con msfvenom.</p><p></p><p><img src="images/151-2.png" alt="images/151-2.png" /></p><p></p><p><h2>Módulos:</h2></p><p><ul><li>→ <h3>→ Detección de criticidad en el malware:</h3></li></ul></p><p></p><p><div class="codebox"><pre><br />python3.6 classifier.py -d ..<span style="color:#000000;font-weight:700">/</span>Desktop<span style="color:#000000;font-weight:700">/</span>putty</pre></div></p><p></p><p><img src="images/151-3.png" alt="images/151-3.png" /></p><p></p><p>Detecta que es malware con una precisión del 92% por lo que es altamente detectable por soluciones antivirus.</p><p></p><p><ul><li>→ <h3>→ Mutación de binarios:</h3></li></ul></p><p></p><p><div class="codebox"><pre><br />python3.6 mutate.py -d ..<span style="color:#000000;font-weight:700">/</span>Desktop<span style="color:#000000;font-weight:700">/</span>putty</pre></div></p><p></p><p><img src="images/151-4.png" alt="images/151-4.png" /></p><p><img src="images/151-5.png" alt="images/151-5.png" /></p><p></p><p></p><p></p><p>Vamos a revisarlo con el clasificador:</p><p></p><p><img src="images/151-6.png" alt="images/151-6.png" /></p><p></p><p>Lo detecta como benigno con un 58% de probabilidad, lo que significa que sería detectado como malware un 42% de las veces.</p><p></p></div>
</body>
</html>
