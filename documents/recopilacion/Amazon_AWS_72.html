<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Amazon AWS</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Amazon AWS</h1><br/><p><h1>Despliegue de un entorno real en la nube (AWS)</h1></p><p></p><p><h2>Escenario de despliegue:</h2></p><p></p><p></p><p><img src="images/72-1.png" alt="images/72-1.png" /></p><p></p><p></p><p>Aplicación web para el despliegue: <a href="https://github.com/aws-samples/simple-phonebook-web-application">https://github.com/aws-samples/simple-phonebook-web-application</a></p><p></p><p></p><p><h2>Pasos para el despliegue:</h2></p><p><ul><li>Creación y configuración de la VPC</li></ul></p><p><ul><li>Creación y configuración de la subred privada</li></ul></p><p><ul><li>Creación y configuración de las subredes públicas</li></ul></p><p><ul><li>Creación y configuración del Internet Gateway</li></ul></p><p><ul><li>Creación y configuración de una Route Table para la subred privada. Asociación de la nueva route table a la subred privada. No debe añadirse ninguna ruta adicional a las que se crean por defecto (ten en cuenta que la ruta por defecto que indica que el tráfico destinado a 10.0.0.0/16 será enrutado localmente es lo que permite que exista conectividad entre todas las subredes que se encuentran en la VPC).</li></ul></p><p><ul><li>Creación y configuración de un Route Table para las subredes públicas. Asociación de la nueva route table a la subred pública. Creación de una nueva ruta que redireccione el tráfico dirigido a 0.0.0.0 hacia el Internet Gateway.</li></ul></p><p><ul><li>Creación y configuración de Security Groups: Creación de dos Security Groups que controlarán las conexiones entrantes y salientes hacia la aplicación web y el servidor de base de datos.<ul><li>Security Group para la aplicación web:<ul><li>Crear regla de entrada para permitir tráfico HTTP desde cualquier dirección IPv4</li><li>Crear regla de entrada para permitir tráfico SSH desde cualquier dirección IPv4</li></ul></li><li>Security Group para la base de datos:<ul><li>Crear regla de entrada para permitir el tráfico MySQL desde el Security Group de la aplicación web</li></ul></li></ul></li></ul></p><p><ul><li>Creación y configuración de los servidores de aplicación en EC2:<ul><li>Script user data para crear las instancias:</li></ul></li></ul></p><p></p><p><div class="codebox"><pre><br /><span style="color:#888a85;font-weight:400">#!/bin/bash</span><br />yum -y <span style="color:#000000;font-weight:700">install</span> httpd php mysql php-mysql<br /><br /><span style="color:#000000;font-weight:700">case</span> $<span style="color:#000000;font-weight:700">(ps</span> -p 1 -o comm <span style="color:#000000;font-weight:700">|</span> <span style="color:#000000;font-weight:700">tail</span> -1<span style="color:#000000;font-weight:700">)</span> <span style="color:#000000;font-weight:700">in</span><br /><span style="color:#000000;font-weight:700">systemd)</span> systemctl <span style="color:#000000;font-weight:700">enable</span> --now httpd <span style="color:#000000;font-weight:700">;;</span><br /><span style="color:#000000;font-weight:700">init)</span> chkconfig httpd on<span style="color:#000000;font-weight:700">;</span> service httpd start <span style="color:#000000;font-weight:700">;;</span><br /><span style="color:#000000;font-weight:700">*)</span> <span style="color:#000000;font-weight:700">echo</span> <span style="color:#edd400;font-weight:400">&quot;Error starting httpd (OS not using init or systemd).&quot;</span> <span style="color:#000000;font-weight:700">2&gt;&amp;</span>1<br /><span style="color:#000000;font-weight:700">esac</span><br /><br /><span style="color:#000000;font-weight:700">if</span> [ <span style="color:#000000;font-weight:700">!</span> -f <span style="color:#000000;font-weight:700">/</span>var<span style="color:#000000;font-weight:700">/</span>www<span style="color:#000000;font-weight:700">/</span>html<span style="color:#000000;font-weight:700">/</span>bootcamp-app.tar.gz ]<span style="color:#000000;font-weight:700">;</span> <span style="color:#000000;font-weight:700">then</span><br /><span style="color:#000000;font-weight:700">cd</span> <span style="color:#000000;font-weight:700">/</span>var<span style="color:#000000;font-weight:700">/</span>www<span style="color:#000000;font-weight:700">/</span>html<br /><span style="color:#000000;font-weight:700">wget</span> https<span style="color:#000000;font-weight:700">://</span>s3.amazonaws.com<span style="color:#000000;font-weight:700">/</span>immersionday-labs<span style="color:#000000;font-weight:700">/</span>bootcamp-app.tar<br /><span style="color:#000000;font-weight:700">tar</span> xvf bootcamp-app.tar<br /><span style="color:#000000;font-weight:700">chown</span> apache<span style="color:#000000;font-weight:700">:</span>root <span style="color:#000000;font-weight:700">/</span>var<span style="color:#000000;font-weight:700">/</span>www<span style="color:#000000;font-weight:700">/</span>html<span style="color:#000000;font-weight:700">/</span>rds.conf.php<br /><span style="color:#000000;font-weight:700">fi</span><br />yum -y update<br /></pre></div></p><p><ul><li>Creación y configuración del Target Group</li></ul></p><p><ul><li>Creación y configuración del Application Load Balancer</li></ul></p><p><ul><li>Creación y configuración del servidor de base de datos MySQL</li></ul></p></div>
</body>
</html>
