<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>ARP Spoofing</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>ARP Spoofing</h1><br/><p></p><p>Cuando sabemos la dirección IP de un equipo de un nodo que puede encontrarse en nuestra red o en otra red diferente, pero no sabemos su dirección física, utilizamos el protocolo a ARP.</p><p></p><p>Mandamos un paquete a todos los nodos de la red preguntándoles por quién tiene esta dirección IP y cuál es tu dirección física.</p><p></p><p>Y ese nodo nos responde diciendo yo tengo esa dirección IP y esta es mi dirección física, esa información la guarda en una caché dentro de mi sistema operativo de manera que si tengo que volver a mandarle información a esa misma dirección IP, no tenga que volver a preguntar por su dirección física.</p><p></p><p>Lo que sucede es que en estas respuestas no existen ningún tipo de verificación o autenticación y ahí es donde aprovechamos para modificar estos paquetes a nuestro favor.</p><p></p><p>Lo que hacemos es envenenar la caché de un dispositivo haciéndole ARP request con información falsa sobre a quién pertenece la dirección IP del router a la que asociamos nuestra MAC.</p><p></p><p>Para ver estas tablas de ARP en caché en windows:</p><p></p><p><div class="codebox"><pre><br />arp <span style="color:#000000;font-weight:700">-</span>a</pre></div></p><p></p><p><img src="images/134-1.png" alt="images/134-1.png" /></p><p></p><p>Para ver los saltos del paquete en nuestra red:</p><p></p><p><div class="codebox"><pre><br />tracert www.google.com</pre></div></p><p></p><p><img src="images/134-2.png" alt="images/134-2.png" /></p><p></p><p>Vemos dos saltos porque se trata del router virtual y luego el router fisico de nuestra red local.</p><p></p><p>Si lanzamos un ping hacia la máquina Kali y capturamos con wireshark vemos que realiza una petición ARP preguntando a quién pertenece la dirección IP que le hemos indicado.</p><p></p><p><img src="images/134-3.png" alt="images/134-3.png" /></p><p></p><p>Manda la petición a todos los nodos y nuestra máquina kali le responde con su dirección MAC que esta máquina windows guarda en cache.</p><p></p><p><img src="images/134-4.png" alt="images/134-4.png" /></p><p></p><p></p><p><h2>Realizamos el spoofing con Bettercap</h2>.</p><p></p><p><div class="codebox"><pre><br />sudo bettercap<br /><span style="color:#729fcf;font-weight:400">set</span> arp.spoof.targets <span style="color:#ce5c00;font-weight:400">192.168</span>.<span style="color:#ce5c00;font-weight:400">239.132</span><br />arp.spoof on<br /></pre></div></p><p></p><p><img src="images/134-5.png" alt="images/134-5.png" /></p><p></p><p>Si abrimos wireshark vemos que básicamente Bettercap está haciendo spam a la maquina objetivo de que la IP que corresponde al router tiene la MAC de nuestra máquina Kali asociada.</p><p></p><p><img src="images/134-6.png" alt="images/134-6.png" /></p><p></p><p>Si en la máquina windows comprobamos el caché ARP.</p><p></p><p><img src="images/134-7.png" alt="images/134-7.png" /></p><p></p><p>Se ha modificado.</p><p></p><p>Ahora cualquier tráfico desde la máquina windows hacia internet pasa por nosotros antes de llegar al router legítimo hacia el servidor y viceversa.</p><p></p><p><img src="images/134-8.png" alt="images/134-8.png" /></p><p></p></div>
</body>
</html>
