<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>AS-REQ Roasting</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>AS-REQ Roasting</h1><br/><p><strong><h1>AS-REQ ROASTING</h1></strong></p><p></p><p>Las técnicas de roasting consisten recaudar una pieza de información en el proceso AS-REQ que haya sido cifrada y tratar de crackearla.</p><p></p><p>En este caso la pieza que obtenemos es el <strong>timestamp</strong> que pide para la pre-autenticación que va cifrado con la clave de usuario con el objetivo de obtenerla.</p><p></p><p>Este proceso es el menos conocido porque es muy complicado conseguir un paquete AS-REQ sin interceptar la comunicación.</p><p></p><p>En esta técnica se presupone que estamos interceptando el tráfico de red de la infraestructura.</p><p></p><p><img src="images/29-1.png" alt="images/29-1.png" /></p><p></p><p>En este caso suponemos que interceptamos el protocolo del inicio de sesión del empleado1, aunque lo ideal es en todo este trafico capturado buscamos paquetes que correspondan a usuarios potenciales como administradores ya que en los paquetes de autenticación podemos ver en plano el nombre de los usuarios.</p><p></p><p>Buscamos el AS-REQ que el usuario envía con el timestamp</p><p></p><p><img src="images/29-2.png" alt="images/29-2.png" /></p><p></p><p>Como vemos es ese bloque cipher cifrado con AES256.</p><p></p><p>Copiamos el valor y lo llevamos a kali en un archivo de texto.</p><p></p><p>Ahora necesitamos un SALT, porque este tipo de cifrado AES256 utiliza un SALT.</p><p>Este lo obtenemos de la respuesta que le hace el AS.</p><p></p><p><img src="images/29-3.png" alt="images/29-3.png" /></p><p></p><p><img src="images/29-4.png" alt="images/29-4.png" /></p><p></p><p>Lo copiamos en el mismo archivo del hash anterior.</p><p></p><p>Lo debemos poner en un formato estándar que esto lo podemos realizar en <a href="https://hashcat.net/wiki/doku.php?id=example_hashes">https://hashcat.net/wiki/doku.php?id=example_hashes</a></p><p></p><p><img src="images/29-5.png" alt="images/29-5.png" /></p><p></p><p>Componemos el hash:</p><p></p><p><div class="codebox"><pre><br /><span style="color:#8ae234;font-weight:700">$krb5pa$1</span>8<span style="color:#8ae234;font-weight:700">$empleado1$CORP</span>.LOCAL<span style="color:#8ae234;font-weight:700">$CORP</span>.LOCALempleado1<span style="color:#8ae234;font-weight:700">$5</span>d8f5a67660edcc6c4e6f45cc43e9485595f835f9dfe3414c04715d3e7633200f8e013108c14831fe87b9d5e5ef880a9191d7b72ebb8ab9a</pre></div></p><p></p><p>Ahora vamos a utilizar Jhon:</p><p></p><p><div class="codebox"><pre><br />john pass.txt</pre></div></p><p></p><p> </p><p></p></div>
</body>
</html>
